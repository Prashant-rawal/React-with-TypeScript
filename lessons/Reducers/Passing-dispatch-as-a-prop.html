<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/React-with-TypeScript/images/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/React-with-TypeScript/images/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/React-with-TypeScript/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="16x16" href="/React-with-TypeScript/images/favicon-16x16.png"/><link rel="icon" type="image/x-icon" href="/React-with-TypeScript/images/favicon.ico"/><title>Passing Dispatch as a Prop – React with TypeScript</title><meta name="description" content="A workshop for start using TypeScript with React"/><meta name="keywords" content="React,react,TypeScript,workshop,Prashant Rawal"/><meta name="og:description" content="A workshop for start using TypeScript with React"/><meta name="og:title" content="Passing Dispatch as a Prop – React with TypeScript"/><meta name="og:image" content="/React-with-TypeScript/images/social-share-cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="next-head-count" content="14"/><link data-next-font="size-adjust" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/React-with-TypeScript/_next/static/css/b0d5392bbfae9df4.css" as="style"/><link rel="stylesheet" href="/React-with-TypeScript/_next/static/css/b0d5392bbfae9df4.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/React-with-TypeScript/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/React-with-TypeScript/_next/static/chunks/webpack-1a3481fa144e7432.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/framework-305cb810cde7afac.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/main-f3c3a156ab1ad8c6.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/pages/_app-c7df7ff57dad61ea.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/pages/lessons/%5Bsection%5D/%5Bslug%5D-9ab3041fb81318ea.js" defer=""></script><script src="/React-with-TypeScript/_next/static/PALjGKd3AshwdXjsrKNVy/_buildManifest.js" defer=""></script><script src="/React-with-TypeScript/_next/static/PALjGKd3AshwdXjsrKNVy/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="remix-app"><header class="navbar"><h1 class="navbar-brand"><a href="/React-with-TypeScript">React with TypeScript</a></h1><div class="navbar-info"></div></header><div class="content-container"><div class="main"><div class="lesson-container"><div class="lesson"><div class="lesson-content"><h1 id="passing-dispatch-as-a-prop"><strong>Passing Dispatch as a prop</strong></h1>
<br>
<!--
Alright, let's start with a new application that allows us to [pick and save colors](https://github.com/stevekinney/colors). I'll start us off and then you'll take it from there for a bit. -->

<p>Right now there is a fair bit of prop drilling and not all of the functionality works just yet. You can select a new color from the color input, but you can&#39;t adjust it from anywhere else.</p>
<!-- My sense is that this would be easier with a reducer and maybe eventually [the Context API](Using%20state%20management%20and%20the%20Context%20API). -->

<p>Let&#39;s start by refactoring the application to use a reducer. I&#39;m going to put mine in <code>lib/reducer.ts</code>, but you can do whatever feels best for you at this time in your life.</p>
<h2 id="starting-with-some-actions">Starting with some actions</h2>
<p>I know at least two of the actions that I&#39;m going to want, so I am going to go ahead and make them now.</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">UpdateHexColorAction</span> = {
  <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;update-hex-color&quot;</span>;
  <span class="hljs-attr">payload</span>: {
    <span class="hljs-attr">hexColor</span>: <span class="hljs-built_in">string</span>;
  };
};

<span class="hljs-keyword">type</span> <span class="hljs-title class_">UpdateRGBColorAction</span> = {
  <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;update-rgb-color&quot;</span>;
  <span class="hljs-attr">payload</span>: { <span class="hljs-attr">rgb</span>: [<span class="hljs-attr">r</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">g</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>] };
};
</code></pre>
<p>My state is also pretty simple. I could—and maybe <em>should</em> add the list of saved colors, but for now let&#39;s start simple as pretty much everything revolves around the <code>hexColor</code> that I have in the top level of my applicastion state.</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">ColorState</span> = {
  <span class="hljs-attr">hexColor</span>: <span class="hljs-built_in">string</span>;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">initialState</span>: <span class="hljs-title class_">ColorState</span> = {
  <span class="hljs-attr">hexColor</span>: <span class="hljs-string">&quot;#ff7799&quot;</span>,
};
</code></pre>
<p>And with that, I think I am ready to make my reducer.</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">const</span> <span class="hljs-title function_">colorReducer</span> = (<span class="hljs-params">
  state: ColorState,
  action: UpdateHexColorAction | UpdateRGBColorAction
</span>) =&gt; {
  <span class="hljs-keyword">if</span> (action.<span class="hljs-property">type</span> === <span class="hljs-string">&quot;update-hex-color&quot;</span>) {
    <span class="hljs-keyword">const</span> { hexColor } = action.<span class="hljs-property">payload</span>;
    <span class="hljs-keyword">return</span> { ...state, hexColor };
  }

  <span class="hljs-keyword">if</span> (action.<span class="hljs-property">type</span> === <span class="hljs-string">&quot;update-rgb-color&quot;</span>) {
    <span class="hljs-keyword">const</span> hexColor = rgb.<span class="hljs-title function_">hex</span>(action.<span class="hljs-property">payload</span>.<span class="hljs-property">rgb</span>);
    <span class="hljs-keyword">return</span> { ...state, hexColor };
  }

  <span class="hljs-keyword">return</span> state;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> colorReducer;
</code></pre>
<h2 id="hooking-up-the-reducer">Hooking up the reducer</h2>
<p>Alright, we&#39;re ready to hook this thing up.</p>
<p>Let&#39;s switch from <code>useState</code> to <code>useReducer</code> in <code>src/components/application.tsx</code>.</p>
<pre><code class="hljs language-diff"><span class="hljs-meta">@@ -1,17 +1,24 @@</span>
<span class="hljs-deletion">-import { useState } from &#x27;react&#x27;;</span>
<span class="hljs-addition">+import { useReducer } from &#x27;react&#x27;;</span>
 import SavedColors from &#x27;./saved-colors&#x27;;
 import RelatedColors from &#x27;./related-colors&#x27;;
 import AdjustColors from &#x27;./adjust-colors&#x27;;
 import ColorPicker from &#x27;./color-picker&#x27;;
<span class="hljs-addition">+import colorReducer, { initialState } from &#x27;../lib/color-reducer&#x27;;</span>

 const Application = () =&gt; {
<span class="hljs-deletion">-  const [hexColor, setHexColor] = useState(&#x27;#e56e24&#x27;);</span>
<span class="hljs-addition">+  const [state, dispatch] = useReducer(colorReducer, initialState);</span>
<span class="hljs-addition">+  const hexColor = state.hexColor;</span>

   return (
     &lt;div className=&quot;grid max-w-3xl grid-cols-1 gap-8 p-8 pb-40 mx-auto dark:bg-slate-900 dark:text-white sm:grid-cols-2&quot;&gt;
       &lt;ColorPicker
         hexColor={hexColor}
<span class="hljs-deletion">-        onChange={(e) =&gt; setHexColor(e.target.value)}</span>
<span class="hljs-addition">+        onChange={(e) =&gt;</span>
<span class="hljs-addition">+          dispatch({</span>
<span class="hljs-addition">+            type: &#x27;update-hex-color&#x27;,</span>
<span class="hljs-addition">+            payload: { hexColor: e.target.value },</span>
<span class="hljs-addition">+          })</span>
<span class="hljs-addition">+        }</span>
       /&gt;
       &lt;AdjustColors hexColor={hexColor} /&gt;
       &lt;RelatedColors hexColor={hexColor} /&gt;
</code></pre>
<p>We can verify that everything works as expected.</p>
<h2 id="adjust-the-color-by-the-rgb-value">Adjust the color by the RGB value</h2>
<p>This is where we&#39;re going to hit another areas that we&#39;ll want to circle back and improve. But, let&#39;s try to figure it out first.</p>
<p>We can see that <code>dispatch</code> has the following type:</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">const</span> <span class="hljs-attr">dispatch</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">Dispatch</span>&lt;<span class="hljs-title class_">UpdateHexColorAction</span> | <span class="hljs-title class_">UpdateRGBColorAction</span>&gt;;
</code></pre>
<p>That&#39;s a union of all of our actions. Let&#39;s actually store that type somewhere so that we can get access to it.</p>
<p>Let&#39;s create <code>lib/color-state.d.ts</code>, and we&#39;ll move our types in there.</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">type</span> <span class="hljs-title class_">UpdateHexColorAction</span> = {
  <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;update-hex-color&quot;</span>;
  <span class="hljs-attr">payload</span>: {
    <span class="hljs-attr">hexColor</span>: <span class="hljs-built_in">string</span>;
  };
};

<span class="hljs-keyword">type</span> <span class="hljs-title class_">UpdateRGBColorAction</span> = {
  <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;update-rgb-color&quot;</span>;
  <span class="hljs-attr">payload</span>: { <span class="hljs-attr">rgb</span>: [<span class="hljs-attr">r</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">g</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>] };
};

<span class="hljs-keyword">type</span> <span class="hljs-title class_">ColorState</span> = {
  <span class="hljs-attr">hexColor</span>: <span class="hljs-built_in">string</span>;
};

<span class="hljs-keyword">type</span> <span class="hljs-title class_">ColorActions</span> = <span class="hljs-title class_">UpdateHexColorAction</span> | <span class="hljs-title class_">UpdateRGBColorAction</span>;
</code></pre>
<p>We&#39;ll update our reducer to use that new <code>ColorActions</code> type we just made.</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">const</span> <span class="hljs-title function_">colorReducer</span> = (<span class="hljs-params">
  state: ColorState = initialState,
  action: ColorActions
</span>) =&gt; {
  <span class="hljs-comment">// …</span>
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> colorReducer;
</code></pre>
<p>Now, if we look at <code>dispatch</code>, it&#39;s a lot easier to wrap our heads around:</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">const</span> <span class="hljs-attr">dispatch</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">Dispatch</span>&lt;<span class="hljs-title class_">ColorActions</span>&gt;;
</code></pre>
<h2 id="typing-and-passing-dispatch-through-as-a-prop">Typing and passing <code>dispatch</code> through as a prop</h2>
<p>We can now reference <code>dispatch</code>&#39;s type super easily. Let&#39;s look at <code>src/components/adjust-colors/index.ts</code>:</p>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">type</span> <span class="hljs-title class_">AdjustColorsProps</span> = {
  <span class="hljs-attr">hexColor</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">dispatch</span>: <span class="hljs-title class_">Dispatch</span>&lt;<span class="hljs-title class_">ColorActions</span>&gt;;
};
</code></pre>
<p>I&#39;ll go ahead and do the same for <code>HexToRGB</code>.</p>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">type</span> <span class="hljs-title class_">HexToRGBProps</span> = {
  <span class="hljs-attr">hexColor</span>: <span class="hljs-built_in">string</span>;
  <span class="hljs-attr">dispatch</span>: <span class="hljs-title class_">Dispatch</span>&lt;<span class="hljs-title class_">ColorActions</span>&gt;;
};
</code></pre>
<p>There is definitely an opportunity to make some of these types more reusable, but we&#39;ll put that off for a bit. Let&#39;s thread <code>dispatch</code> from <code>Application</code> through <code>AdjustColor</code> to <code>HexToRGB</code>.</p>
<p>In <code>src/components/application.tsx</code>:</p>
<pre><code class="hljs language-diff"><span class="hljs-meta">@@ -20,7 +20,7 @@</span> const Application = () =&gt; {
           })
         }
       /&gt;
<span class="hljs-deletion">-      &lt;AdjustColors hexColor={hexColor} /&gt;</span>
<span class="hljs-addition">+      &lt;AdjustColors hexColor={hexColor} dispatch={dispatch} /&gt;</span>
       &lt;RelatedColors hexColor={hexColor} /&gt;
       &lt;SavedColors hexColor={hexColor} /&gt;
     &lt;/div&gt;
</code></pre>
<p>In <code>src/components/adjust-colors/</code>:</p>
<pre><code class="hljs language-diff"><span class="hljs-meta">@@ -10,11 +10,11 @@</span> type AdjustColorsProps = {
   dispatch: Dispatch&lt;ColorActions&gt;;
 };

<span class="hljs-deletion">-const AdjustColors = ({ hexColor }: AdjustColorsProps) =&gt; {</span>
<span class="hljs-addition">+const AdjustColors = ({ hexColor, dispatch }: AdjustColorsProps) =&gt; {</span>
   return (
     &lt;div className=&quot;flex flex-col w-full gap-4&quot;&gt;
       &lt;h3&gt;Adjust Colors&lt;/h3&gt;
<span class="hljs-deletion">-      &lt;HexToRGB hexColor={hexColor} /&gt;</span>
<span class="hljs-addition">+      &lt;HexToRGB hexColor={hexColor} dispatch={dispatch} /&gt;</span>
       &lt;HexToHSL hexColor={hexColor} /&gt;
       &lt;HexToHSV hexColor={hexColor} /&gt;
       &lt;HexToCMYK hexColor={hexColor} /&gt;
</code></pre>
<p>And finally, in <code>src/components/adjust-colors/to-rgb.tsx</code>:</p>
<pre><code class="hljs language-diff"><span class="hljs-meta">@@ -7,7 +7,7 @@</span> type HexToRGBProps = {
   dispatch: Dispatch&lt;ColorActions&gt;;
 };

<span class="hljs-deletion">-const HexToRGB = ({ hexColor }: HexToRGBProps) =&gt; {</span>
<span class="hljs-addition">+const HexToRGB = ({ hexColor, dispatch }: HexToRGBProps) =&gt; {</span>
   const color = hex.cmyk(hexColor);
   const [r, g, b] = color;
</code></pre>
<h2 id="firing-an-action-when-the-rgb-values-change">Firing an action when the RGB values change</h2>
<p>We&#39;ve got some more optimization to do, but we&#39;ll revisit this later. Our mission right now is to dispatch that action with the newest RGB values.</p>
<pre><code class="hljs language-ts"><span class="hljs-keyword">const</span> <span class="hljs-title function_">HexToRGB</span> = (<span class="hljs-params">{ hexColor, dispatch }: HexToRGBProps</span>) =&gt; {
  <span class="hljs-keyword">const</span> color = hex.<span class="hljs-title function_">rgb</span>(hexColor);
  <span class="hljs-keyword">const</span> [r, g, b] = color;

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">updateRGB</span> = (<span class="hljs-params">{ red = r, green = g, blue = b }</span>) =&gt; {
    <span class="hljs-title function_">dispatch</span>({
      <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;update-rgb-color&quot;</span>,
      <span class="hljs-attr">payload</span>: { <span class="hljs-attr">rgb</span>: [red, green, blue] },
    });
  };

  <span class="hljs-keyword">return</span> (
    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;grid w-full grid-flow-col gap-2&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">LabeledInput</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;R&quot;</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;number&quot;</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{r}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateRGB({ red: +e.target.value })}
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">LabeledInput</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;G&quot;</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;number&quot;</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{g}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateRGB({ green: +e.target.value })}
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">LabeledInput</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;B&quot;</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;number&quot;</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{b}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateRGB({ blue: +e.target.value })}
      /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">HexToRGB</span>;
</code></pre>
</div><div class="lesson-links"><a href="/React-with-TypeScript/lessons/Reducers/working-with-reducers" class="prev">← Previous</a><a href="/React-with-TypeScript/lessons/Reducers/Typing-action-and-reducers" class="next">Next →</a></div></div><div class="details-bg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="154" height="154" viewBox="0 0 154 154"><defs><clipPath id="clip-path"><rect id="Rectangle_2238" data-name="Rectangle 2238" width="154" height="154" transform="translate(9467 350)" fill="#fff" stroke="#707070" stroke-width="1"></rect></clipPath><clipPath id="clip-corner-image-active"><rect width="154" height="154"></rect></clipPath></defs><g id="corner-image-active" clip-path="url(#clip-corner-image-active)"><g id="Corner-image-active-2" data-name="Corner-image-active" transform="translate(-9467 -350)" clip-path="url(#clip-path)"><path id="Subtraction_34" data-name="Subtraction 34" d="M-3857.365,1740.766h0l-7.07-7.07,12.89-12.89v14.142l-5.818,5.818Zm-14.142-14.142h0l-7.071-7.07,27.033-27.033v14.143l-19.96,19.96Zm-14.143-14.143h0l-7.07-7.069,41.175-41.175v14.142Zm-14.142-14.142h0l-7.07-7.069,55.317-55.317v14.142Zm-14.142-14.142h0l-7.07-7.069,69.459-69.459v14.142Zm-14.142-14.142h0l-7.07-7.069,76.739-76.739h6.862v7.28Zm-14.143-14.143h0l-7.07-7.069,62.6-62.6h14.142Zm-14.142-14.142h0l-7.07-7.069,48.454-48.454h14.142Zm-14.142-14.142h0l-7.07-7.069,34.312-34.312h14.142Zm-14.142-14.142h0l-7.07-7.069,20.17-20.17h14.142Zm-14.142-14.142h0l-7.071-7.071,6.027-6.027h14.144l-13.1,13.1Zm367.24-56.114v-.909l.455.455-.453.453Z" transform="translate(13472.546 -1236.766)" fill="var(--corner-fill)"></path></g></g></svg></div></div></div></div><footer class="footer"><ul class="socials"><li class="social"><a href="https://github.com/https://github.com/IAmCuriousDeveloper"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-github-social"><rect width="32" height="32"></rect></clipPath></defs><g id="github-social" clip-path="url(#clip-github-social)"><g id="Group_272" data-name="Group 272" transform="translate(13522.5 -6994)"><path id="Subtraction_33" data-name="Subtraction 33" d="M-24967.5,8041a15.9,15.9,0,0,1-11.312-4.688A15.893,15.893,0,0,1-24983.5,8025a15.893,15.893,0,0,1,4.689-11.315A15.894,15.894,0,0,1-24967.5,8009a15.894,15.894,0,0,1,11.313,4.686A15.893,15.893,0,0,1-24951.5,8025a15.893,15.893,0,0,1-4.689,11.313A15.9,15.9,0,0,1-24967.5,8041Zm-3.781-4.571h0v3.918h7.895v-6.665a1.836,1.836,0,0,0-1.2-1.718c5.1-.617,7.467-2.975,7.467-7.424a7.176,7.176,0,0,0-1.637-4.728,6.74,6.74,0,0,0,.275-1.812,4.34,4.34,0,0,0-.52-2.452.574.574,0,0,0-.359-.1c-1.061,0-3.465,1.411-3.936,1.694a16.644,16.644,0,0,0-4.2-.489,16.379,16.379,0,0,0-3.969.445c-.846-.5-2.91-1.649-3.859-1.649a.566.566,0,0,0-.354.095,4.3,4.3,0,0,0-.521,2.452,6.7,6.7,0,0,0,.244,1.718,7.346,7.346,0,0,0-1.6,4.822,7.263,7.263,0,0,0,1.533,4.985c1.193,1.359,3.115,2.165,5.871,2.464a1.826,1.826,0,0,0-1.129,1.693v.5h0l-.006,0a7.121,7.121,0,0,1-2.033.363,2.608,2.608,0,0,1-.965-.158,4.438,4.438,0,0,1-1.836-1.881,2.361,2.361,0,0,0-1.248-1.091,3.472,3.472,0,0,0-1.217-.3.584.584,0,0,0-.545.224.282.282,0,0,0,.027.367,1.875,1.875,0,0,0,.447.307,4.732,4.732,0,0,1,.561.355,10.726,10.726,0,0,1,1.682,2.755c.043.092.078.163.105.217a3.876,3.876,0,0,0,2.42,1.185,6.036,6.036,0,0,0,.607.025c.875,0,1.988-.124,2-.125Z" transform="translate(11461 -1015)" fill="var(--footer-icons)"></path><g id="Ellipse_670" data-name="Ellipse 670" transform="translate(-13522.5 6994)" fill="none" stroke="var(--footer-icons)" stroke-width="1"><circle cx="16" cy="16" r="16" stroke="none"></circle><circle cx="16" cy="16" r="15.5" fill="none"></circle></g></g></g></svg></a></li><li class="social"><a href="https://linkedin.com/in/https://in.linkedin.com/in/prashant-rawal-12142b117"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-linkedin-social"><rect width="32" height="32"></rect></clipPath></defs><g id="linkedin-social" clip-path="url(#clip-linkedin-social)"><g id="Group_270" data-name="Group 270" transform="translate(-86.349 -633.073)"><path id="Path_375" data-name="Path 375" d="M115.789,633.073a2.324,2.324,0,0,1,1.682.676,2.194,2.194,0,0,1,.695,1.627V662.8a2.131,2.131,0,0,1-.695,1.609,2.314,2.314,0,0,1-1.646.659H88.69a2.307,2.307,0,0,1-1.646-.659,2.128,2.128,0,0,1-.695-1.609V635.376a2.19,2.19,0,0,1,.695-1.627,2.322,2.322,0,0,1,1.682-.676h27.063Zm-20.224,9.672a2.561,2.561,0,0,0,0-3.584,2.658,2.658,0,0,0-1.938-.712,2.724,2.724,0,0,0-1.957.712,2.371,2.371,0,0,0-.75,1.792,2.4,2.4,0,0,0,.731,1.792,2.605,2.605,0,0,0,1.9.713h.037A2.7,2.7,0,0,0,95.565,642.745ZM96,645.434H91.213V659.88H96Zm17.3,6.144a7.007,7.007,0,0,0-1.573-4.9,5.68,5.68,0,0,0-6.839-.769,5.663,5.663,0,0,0-1.426,1.573v-2.048H98.674q.036.841,0,7.717v6.728h4.791V651.8a3.592,3.592,0,0,1,.146-1.17,2.913,2.913,0,0,1,.878-1.206,2.429,2.429,0,0,1,1.609-.549,2.108,2.108,0,0,1,1.865.914,4.265,4.265,0,0,1,.549,2.341v7.752H113.3Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><div class="terms"><p>Content Licensed Under CC-BY-NC-4.0</p><p>Code Samples and Excercises Licensed Under Apache 2.0</p><p>Site Designed by<!-- --> <a href="https://in.linkedin.com/in/prashant-rawal-12142b117">Prashant Rawal</a></p><p>Please respect the creator</p></div></li></ul></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"attributes":{},"html":"\u003ch1 id=\"passing-dispatch-as-a-prop\"\u003e\u003cstrong\u003ePassing Dispatch as a prop\u003c/strong\u003e\u003c/h1\u003e\n\u003cbr\u003e\n\u003c!--\nAlright, let's start with a new application that allows us to [pick and save colors](https://github.com/stevekinney/colors). I'll start us off and then you'll take it from there for a bit. --\u003e\n\n\u003cp\u003eRight now there is a fair bit of prop drilling and not all of the functionality works just yet. You can select a new color from the color input, but you can\u0026#39;t adjust it from anywhere else.\u003c/p\u003e\n\u003c!-- My sense is that this would be easier with a reducer and maybe eventually [the Context API](Using%20state%20management%20and%20the%20Context%20API). --\u003e\n\n\u003cp\u003eLet\u0026#39;s start by refactoring the application to use a reducer. I\u0026#39;m going to put mine in \u003ccode\u003elib/reducer.ts\u003c/code\u003e, but you can do whatever feels best for you at this time in your life.\u003c/p\u003e\n\u003ch2 id=\"starting-with-some-actions\"\u003eStarting with some actions\u003c/h2\u003e\n\u003cp\u003eI know at least two of the actions that I\u0026#39;m going to want, so I am going to go ahead and make them now.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUpdateHexColorAction\u003c/span\u003e = {\n  \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;update-hex-color\u0026quot;\u003c/span\u003e;\n  \u003cspan class=\"hljs-attr\"\u003epayload\u003c/span\u003e: {\n    \u003cspan class=\"hljs-attr\"\u003ehexColor\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e;\n  };\n};\n\n\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUpdateRGBColorAction\u003c/span\u003e = {\n  \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;update-rgb-color\u0026quot;\u003c/span\u003e;\n  \u003cspan class=\"hljs-attr\"\u003epayload\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003ergb\u003c/span\u003e: [\u003cspan class=\"hljs-attr\"\u003er\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eg\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eb\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e] };\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eMy state is also pretty simple. I could—and maybe \u003cem\u003eshould\u003c/em\u003e add the list of saved colors, but for now let\u0026#39;s start simple as pretty much everything revolves around the \u003ccode\u003ehexColor\u003c/code\u003e that I have in the top level of my applicastion state.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eColorState\u003c/span\u003e = {\n  \u003cspan class=\"hljs-attr\"\u003ehexColor\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e;\n};\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003einitialState\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eColorState\u003c/span\u003e = {\n  \u003cspan class=\"hljs-attr\"\u003ehexColor\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;#ff7799\u0026quot;\u003c/span\u003e,\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnd with that, I think I am ready to make my reducer.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003ecolorReducer\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003e\n  state: ColorState,\n  action: UpdateHexColorAction | UpdateRGBColorAction\n\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (action.\u003cspan class=\"hljs-property\"\u003etype\u003c/span\u003e === \u003cspan class=\"hljs-string\"\u003e\u0026quot;update-hex-color\u0026quot;\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { hexColor } = action.\u003cspan class=\"hljs-property\"\u003epayload\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e { ...state, hexColor };\n  }\n\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (action.\u003cspan class=\"hljs-property\"\u003etype\u003c/span\u003e === \u003cspan class=\"hljs-string\"\u003e\u0026quot;update-rgb-color\u0026quot;\u003c/span\u003e) {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e hexColor = rgb.\u003cspan class=\"hljs-title function_\"\u003ehex\u003c/span\u003e(action.\u003cspan class=\"hljs-property\"\u003epayload\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003ergb\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e { ...state, hexColor };\n  }\n\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e state;\n};\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e colorReducer;\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"hooking-up-the-reducer\"\u003eHooking up the reducer\u003c/h2\u003e\n\u003cp\u003eAlright, we\u0026#39;re ready to hook this thing up.\u003c/p\u003e\n\u003cp\u003eLet\u0026#39;s switch from \u003ccode\u003euseState\u003c/code\u003e to \u003ccode\u003euseReducer\u003c/code\u003e in \u003ccode\u003esrc/components/application.tsx\u003c/code\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-diff\"\u003e\u003cspan class=\"hljs-meta\"\u003e@@ -1,17 +1,24 @@\u003c/span\u003e\n\u003cspan class=\"hljs-deletion\"\u003e-import { useState } from \u0026#x27;react\u0026#x27;;\u003c/span\u003e\n\u003cspan class=\"hljs-addition\"\u003e+import { useReducer } from \u0026#x27;react\u0026#x27;;\u003c/span\u003e\n import SavedColors from \u0026#x27;./saved-colors\u0026#x27;;\n import RelatedColors from \u0026#x27;./related-colors\u0026#x27;;\n import AdjustColors from \u0026#x27;./adjust-colors\u0026#x27;;\n import ColorPicker from \u0026#x27;./color-picker\u0026#x27;;\n\u003cspan class=\"hljs-addition\"\u003e+import colorReducer, { initialState } from \u0026#x27;../lib/color-reducer\u0026#x27;;\u003c/span\u003e\n\n const Application = () =\u0026gt; {\n\u003cspan class=\"hljs-deletion\"\u003e-  const [hexColor, setHexColor] = useState(\u0026#x27;#e56e24\u0026#x27;);\u003c/span\u003e\n\u003cspan class=\"hljs-addition\"\u003e+  const [state, dispatch] = useReducer(colorReducer, initialState);\u003c/span\u003e\n\u003cspan class=\"hljs-addition\"\u003e+  const hexColor = state.hexColor;\u003c/span\u003e\n\n   return (\n     \u0026lt;div className=\u0026quot;grid max-w-3xl grid-cols-1 gap-8 p-8 pb-40 mx-auto dark:bg-slate-900 dark:text-white sm:grid-cols-2\u0026quot;\u0026gt;\n       \u0026lt;ColorPicker\n         hexColor={hexColor}\n\u003cspan class=\"hljs-deletion\"\u003e-        onChange={(e) =\u0026gt; setHexColor(e.target.value)}\u003c/span\u003e\n\u003cspan class=\"hljs-addition\"\u003e+        onChange={(e) =\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-addition\"\u003e+          dispatch({\u003c/span\u003e\n\u003cspan class=\"hljs-addition\"\u003e+            type: \u0026#x27;update-hex-color\u0026#x27;,\u003c/span\u003e\n\u003cspan class=\"hljs-addition\"\u003e+            payload: { hexColor: e.target.value },\u003c/span\u003e\n\u003cspan class=\"hljs-addition\"\u003e+          })\u003c/span\u003e\n\u003cspan class=\"hljs-addition\"\u003e+        }\u003c/span\u003e\n       /\u0026gt;\n       \u0026lt;AdjustColors hexColor={hexColor} /\u0026gt;\n       \u0026lt;RelatedColors hexColor={hexColor} /\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe can verify that everything works as expected.\u003c/p\u003e\n\u003ch2 id=\"adjust-the-color-by-the-rgb-value\"\u003eAdjust the color by the RGB value\u003c/h2\u003e\n\u003cp\u003eThis is where we\u0026#39;re going to hit another areas that we\u0026#39;ll want to circle back and improve. But, let\u0026#39;s try to figure it out first.\u003c/p\u003e\n\u003cp\u003eWe can see that \u003ccode\u003edispatch\u003c/code\u003e has the following type:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003edispatch\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eReact\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eDispatch\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-title class_\"\u003eUpdateHexColorAction\u003c/span\u003e | \u003cspan class=\"hljs-title class_\"\u003eUpdateRGBColorAction\u003c/span\u003e\u0026gt;;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThat\u0026#39;s a union of all of our actions. Let\u0026#39;s actually store that type somewhere so that we can get access to it.\u003c/p\u003e\n\u003cp\u003eLet\u0026#39;s create \u003ccode\u003elib/color-state.d.ts\u003c/code\u003e, and we\u0026#39;ll move our types in there.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUpdateHexColorAction\u003c/span\u003e = {\n  \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;update-hex-color\u0026quot;\u003c/span\u003e;\n  \u003cspan class=\"hljs-attr\"\u003epayload\u003c/span\u003e: {\n    \u003cspan class=\"hljs-attr\"\u003ehexColor\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e;\n  };\n};\n\n\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eUpdateRGBColorAction\u003c/span\u003e = {\n  \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;update-rgb-color\u0026quot;\u003c/span\u003e;\n  \u003cspan class=\"hljs-attr\"\u003epayload\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003ergb\u003c/span\u003e: [\u003cspan class=\"hljs-attr\"\u003er\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eg\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eb\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003enumber\u003c/span\u003e] };\n};\n\n\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eColorState\u003c/span\u003e = {\n  \u003cspan class=\"hljs-attr\"\u003ehexColor\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e;\n};\n\n\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eColorActions\u003c/span\u003e = \u003cspan class=\"hljs-title class_\"\u003eUpdateHexColorAction\u003c/span\u003e | \u003cspan class=\"hljs-title class_\"\u003eUpdateRGBColorAction\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe\u0026#39;ll update our reducer to use that new \u003ccode\u003eColorActions\u003c/code\u003e type we just made.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003ecolorReducer\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003e\n  state: ColorState = initialState,\n  action: ColorActions\n\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-comment\"\u003e// …\u003c/span\u003e\n};\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e colorReducer;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow, if we look at \u003ccode\u003edispatch\u003c/code\u003e, it\u0026#39;s a lot easier to wrap our heads around:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003edispatch\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eReact\u003c/span\u003e.\u003cspan class=\"hljs-property\"\u003eDispatch\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-title class_\"\u003eColorActions\u003c/span\u003e\u0026gt;;\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"typing-and-passing-dispatch-through-as-a-prop\"\u003eTyping and passing \u003ccode\u003edispatch\u003c/code\u003e through as a prop\u003c/h2\u003e\n\u003cp\u003eWe can now reference \u003ccode\u003edispatch\u003c/code\u003e\u0026#39;s type super easily. Let\u0026#39;s look at \u003ccode\u003esrc/components/adjust-colors/index.ts\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-tsx\"\u003e\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eAdjustColorsProps\u003c/span\u003e = {\n  \u003cspan class=\"hljs-attr\"\u003ehexColor\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e;\n  \u003cspan class=\"hljs-attr\"\u003edispatch\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eDispatch\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-title class_\"\u003eColorActions\u003c/span\u003e\u0026gt;;\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI\u0026#39;ll go ahead and do the same for \u003ccode\u003eHexToRGB\u003c/code\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-tsx\"\u003e\u003cspan class=\"hljs-keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHexToRGBProps\u003c/span\u003e = {\n  \u003cspan class=\"hljs-attr\"\u003ehexColor\u003c/span\u003e: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e;\n  \u003cspan class=\"hljs-attr\"\u003edispatch\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eDispatch\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-title class_\"\u003eColorActions\u003c/span\u003e\u0026gt;;\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThere is definitely an opportunity to make some of these types more reusable, but we\u0026#39;ll put that off for a bit. Let\u0026#39;s thread \u003ccode\u003edispatch\u003c/code\u003e from \u003ccode\u003eApplication\u003c/code\u003e through \u003ccode\u003eAdjustColor\u003c/code\u003e to \u003ccode\u003eHexToRGB\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eIn \u003ccode\u003esrc/components/application.tsx\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-diff\"\u003e\u003cspan class=\"hljs-meta\"\u003e@@ -20,7 +20,7 @@\u003c/span\u003e const Application = () =\u0026gt; {\n           })\n         }\n       /\u0026gt;\n\u003cspan class=\"hljs-deletion\"\u003e-      \u0026lt;AdjustColors hexColor={hexColor} /\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-addition\"\u003e+      \u0026lt;AdjustColors hexColor={hexColor} dispatch={dispatch} /\u0026gt;\u003c/span\u003e\n       \u0026lt;RelatedColors hexColor={hexColor} /\u0026gt;\n       \u0026lt;SavedColors hexColor={hexColor} /\u0026gt;\n     \u0026lt;/div\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn \u003ccode\u003esrc/components/adjust-colors/\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-diff\"\u003e\u003cspan class=\"hljs-meta\"\u003e@@ -10,11 +10,11 @@\u003c/span\u003e type AdjustColorsProps = {\n   dispatch: Dispatch\u0026lt;ColorActions\u0026gt;;\n };\n\n\u003cspan class=\"hljs-deletion\"\u003e-const AdjustColors = ({ hexColor }: AdjustColorsProps) =\u0026gt; {\u003c/span\u003e\n\u003cspan class=\"hljs-addition\"\u003e+const AdjustColors = ({ hexColor, dispatch }: AdjustColorsProps) =\u0026gt; {\u003c/span\u003e\n   return (\n     \u0026lt;div className=\u0026quot;flex flex-col w-full gap-4\u0026quot;\u0026gt;\n       \u0026lt;h3\u0026gt;Adjust Colors\u0026lt;/h3\u0026gt;\n\u003cspan class=\"hljs-deletion\"\u003e-      \u0026lt;HexToRGB hexColor={hexColor} /\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-addition\"\u003e+      \u0026lt;HexToRGB hexColor={hexColor} dispatch={dispatch} /\u0026gt;\u003c/span\u003e\n       \u0026lt;HexToHSL hexColor={hexColor} /\u0026gt;\n       \u0026lt;HexToHSV hexColor={hexColor} /\u0026gt;\n       \u0026lt;HexToCMYK hexColor={hexColor} /\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnd finally, in \u003ccode\u003esrc/components/adjust-colors/to-rgb.tsx\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-diff\"\u003e\u003cspan class=\"hljs-meta\"\u003e@@ -7,7 +7,7 @@\u003c/span\u003e type HexToRGBProps = {\n   dispatch: Dispatch\u0026lt;ColorActions\u0026gt;;\n };\n\n\u003cspan class=\"hljs-deletion\"\u003e-const HexToRGB = ({ hexColor }: HexToRGBProps) =\u0026gt; {\u003c/span\u003e\n\u003cspan class=\"hljs-addition\"\u003e+const HexToRGB = ({ hexColor, dispatch }: HexToRGBProps) =\u0026gt; {\u003c/span\u003e\n   const color = hex.cmyk(hexColor);\n   const [r, g, b] = color;\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"firing-an-action-when-the-rgb-values-change\"\u003eFiring an action when the RGB values change\u003c/h2\u003e\n\u003cp\u003eWe\u0026#39;ve got some more optimization to do, but we\u0026#39;ll revisit this later. Our mission right now is to dispatch that action with the newest RGB values.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eHexToRGB\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003e{ hexColor, dispatch }: HexToRGBProps\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e color = hex.\u003cspan class=\"hljs-title function_\"\u003ergb\u003c/span\u003e(hexColor);\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e [r, g, b] = color;\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eupdateRGB\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003e{ red = r, green = g, blue = b }\u003c/span\u003e) =\u0026gt; {\n    \u003cspan class=\"hljs-title function_\"\u003edispatch\u003c/span\u003e({\n      \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;update-rgb-color\u0026quot;\u003c/span\u003e,\n      \u003cspan class=\"hljs-attr\"\u003epayload\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003ergb\u003c/span\u003e: [red, green, blue] },\n    });\n  };\n\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\n    \u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003esection\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;grid w-full grid-flow-col gap-2\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eLabeledInput\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003elabel\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;R\u0026quot;\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;number\u0026quot;\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{r}\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003eonChange\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{(e)\u003c/span\u003e =\u0026gt;\u003c/span\u003e updateRGB({ red: +e.target.value })}\n      /\u0026gt;\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eLabeledInput\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003elabel\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;G\u0026quot;\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;number\u0026quot;\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{g}\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003eonChange\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{(e)\u003c/span\u003e =\u0026gt;\u003c/span\u003e updateRGB({ green: +e.target.value })}\n      /\u0026gt;\n      \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eLabeledInput\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003elabel\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;B\u0026quot;\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;number\u0026quot;\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003evalue\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{b}\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003eonChange\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{(e)\u003c/span\u003e =\u0026gt;\u003c/span\u003e updateRGB({ blue: +e.target.value })}\n      /\u0026gt;\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003esection\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n  );\n};\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eHexToRGB\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n","markdown":"# **Passing Dispatch as a prop**\n\n\u003cbr\u003e\n\u003c!--\nAlright, let's start with a new application that allows us to [pick and save colors](https://github.com/stevekinney/colors). I'll start us off and then you'll take it from there for a bit. --\u003e\n\nRight now there is a fair bit of prop drilling and not all of the functionality works just yet. You can select a new color from the color input, but you can't adjust it from anywhere else.\n\n\u003c!-- My sense is that this would be easier with a reducer and maybe eventually [the Context API](Using%20state%20management%20and%20the%20Context%20API). --\u003e\n\nLet's start by refactoring the application to use a reducer. I'm going to put mine in `lib/reducer.ts`, but you can do whatever feels best for you at this time in your life.\n\n## Starting with some actions\n\nI know at least two of the actions that I'm going to want, so I am going to go ahead and make them now.\n\n```ts\ntype UpdateHexColorAction = {\n  type: \"update-hex-color\";\n  payload: {\n    hexColor: string;\n  };\n};\n\ntype UpdateRGBColorAction = {\n  type: \"update-rgb-color\";\n  payload: { rgb: [r: number, g: number, b: number] };\n};\n```\n\nMy state is also pretty simple. I could—and maybe _should_ add the list of saved colors, but for now let's start simple as pretty much everything revolves around the `hexColor` that I have in the top level of my applicastion state.\n\n```ts\ntype ColorState = {\n  hexColor: string;\n};\n\nexport const initialState: ColorState = {\n  hexColor: \"#ff7799\",\n};\n```\n\nAnd with that, I think I am ready to make my reducer.\n\n```ts\nconst colorReducer = (\n  state: ColorState,\n  action: UpdateHexColorAction | UpdateRGBColorAction\n) =\u003e {\n  if (action.type === \"update-hex-color\") {\n    const { hexColor } = action.payload;\n    return { ...state, hexColor };\n  }\n\n  if (action.type === \"update-rgb-color\") {\n    const hexColor = rgb.hex(action.payload.rgb);\n    return { ...state, hexColor };\n  }\n\n  return state;\n};\n\nexport default colorReducer;\n```\n\n## Hooking up the reducer\n\nAlright, we're ready to hook this thing up.\n\nLet's switch from `useState` to `useReducer` in `src/components/application.tsx`.\n\n```diff\n@@ -1,17 +1,24 @@\n-import { useState } from 'react';\n+import { useReducer } from 'react';\n import SavedColors from './saved-colors';\n import RelatedColors from './related-colors';\n import AdjustColors from './adjust-colors';\n import ColorPicker from './color-picker';\n+import colorReducer, { initialState } from '../lib/color-reducer';\n\n const Application = () =\u003e {\n-  const [hexColor, setHexColor] = useState('#e56e24');\n+  const [state, dispatch] = useReducer(colorReducer, initialState);\n+  const hexColor = state.hexColor;\n\n   return (\n     \u003cdiv className=\"grid max-w-3xl grid-cols-1 gap-8 p-8 pb-40 mx-auto dark:bg-slate-900 dark:text-white sm:grid-cols-2\"\u003e\n       \u003cColorPicker\n         hexColor={hexColor}\n-        onChange={(e) =\u003e setHexColor(e.target.value)}\n+        onChange={(e) =\u003e\n+          dispatch({\n+            type: 'update-hex-color',\n+            payload: { hexColor: e.target.value },\n+          })\n+        }\n       /\u003e\n       \u003cAdjustColors hexColor={hexColor} /\u003e\n       \u003cRelatedColors hexColor={hexColor} /\u003e\n\n```\n\nWe can verify that everything works as expected.\n\n## Adjust the color by the RGB value\n\nThis is where we're going to hit another areas that we'll want to circle back and improve. But, let's try to figure it out first.\n\nWe can see that `dispatch` has the following type:\n\n```ts\nconst dispatch: React.Dispatch\u003cUpdateHexColorAction | UpdateRGBColorAction\u003e;\n```\n\nThat's a union of all of our actions. Let's actually store that type somewhere so that we can get access to it.\n\nLet's create `lib/color-state.d.ts`, and we'll move our types in there.\n\n```ts\ntype UpdateHexColorAction = {\n  type: \"update-hex-color\";\n  payload: {\n    hexColor: string;\n  };\n};\n\ntype UpdateRGBColorAction = {\n  type: \"update-rgb-color\";\n  payload: { rgb: [r: number, g: number, b: number] };\n};\n\ntype ColorState = {\n  hexColor: string;\n};\n\ntype ColorActions = UpdateHexColorAction | UpdateRGBColorAction;\n```\n\nWe'll update our reducer to use that new `ColorActions` type we just made.\n\n```ts\nconst colorReducer = (\n  state: ColorState = initialState,\n  action: ColorActions\n) =\u003e {\n  // …\n};\n\nexport default colorReducer;\n```\n\nNow, if we look at `dispatch`, it's a lot easier to wrap our heads around:\n\n```ts\nconst dispatch: React.Dispatch\u003cColorActions\u003e;\n```\n\n## Typing and passing `dispatch` through as a prop\n\nWe can now reference `dispatch`'s type super easily. Let's look at `src/components/adjust-colors/index.ts`:\n\n```tsx\ntype AdjustColorsProps = {\n  hexColor: string;\n  dispatch: Dispatch\u003cColorActions\u003e;\n};\n```\n\nI'll go ahead and do the same for `HexToRGB`.\n\n```tsx\ntype HexToRGBProps = {\n  hexColor: string;\n  dispatch: Dispatch\u003cColorActions\u003e;\n};\n```\n\nThere is definitely an opportunity to make some of these types more reusable, but we'll put that off for a bit. Let's thread `dispatch` from `Application` through `AdjustColor` to `HexToRGB`.\n\nIn `src/components/application.tsx`:\n\n```diff\n@@ -20,7 +20,7 @@ const Application = () =\u003e {\n           })\n         }\n       /\u003e\n-      \u003cAdjustColors hexColor={hexColor} /\u003e\n+      \u003cAdjustColors hexColor={hexColor} dispatch={dispatch} /\u003e\n       \u003cRelatedColors hexColor={hexColor} /\u003e\n       \u003cSavedColors hexColor={hexColor} /\u003e\n     \u003c/div\u003e\n```\n\nIn `src/components/adjust-colors/`:\n\n```diff\n@@ -10,11 +10,11 @@ type AdjustColorsProps = {\n   dispatch: Dispatch\u003cColorActions\u003e;\n };\n\n-const AdjustColors = ({ hexColor }: AdjustColorsProps) =\u003e {\n+const AdjustColors = ({ hexColor, dispatch }: AdjustColorsProps) =\u003e {\n   return (\n     \u003cdiv className=\"flex flex-col w-full gap-4\"\u003e\n       \u003ch3\u003eAdjust Colors\u003c/h3\u003e\n-      \u003cHexToRGB hexColor={hexColor} /\u003e\n+      \u003cHexToRGB hexColor={hexColor} dispatch={dispatch} /\u003e\n       \u003cHexToHSL hexColor={hexColor} /\u003e\n       \u003cHexToHSV hexColor={hexColor} /\u003e\n       \u003cHexToCMYK hexColor={hexColor} /\u003e\n```\n\nAnd finally, in `src/components/adjust-colors/to-rgb.tsx`:\n\n```diff\n@@ -7,7 +7,7 @@ type HexToRGBProps = {\n   dispatch: Dispatch\u003cColorActions\u003e;\n };\n\n-const HexToRGB = ({ hexColor }: HexToRGBProps) =\u003e {\n+const HexToRGB = ({ hexColor, dispatch }: HexToRGBProps) =\u003e {\n   const color = hex.cmyk(hexColor);\n   const [r, g, b] = color;\n```\n\n## Firing an action when the RGB values change\n\nWe've got some more optimization to do, but we'll revisit this later. Our mission right now is to dispatch that action with the newest RGB values.\n\n```ts\nconst HexToRGB = ({ hexColor, dispatch }: HexToRGBProps) =\u003e {\n  const color = hex.rgb(hexColor);\n  const [r, g, b] = color;\n\n  const updateRGB = ({ red = r, green = g, blue = b }) =\u003e {\n    dispatch({\n      type: \"update-rgb-color\",\n      payload: { rgb: [red, green, blue] },\n    });\n  };\n\n  return (\n    \u003csection className=\"grid w-full grid-flow-col gap-2\"\u003e\n      \u003cLabeledInput\n        label=\"R\"\n        type=\"number\"\n        value={r}\n        onChange={(e) =\u003e updateRGB({ red: +e.target.value })}\n      /\u003e\n      \u003cLabeledInput\n        label=\"G\"\n        type=\"number\"\n        value={g}\n        onChange={(e) =\u003e updateRGB({ green: +e.target.value })}\n      /\u003e\n      \u003cLabeledInput\n        label=\"B\"\n        type=\"number\"\n        value={b}\n        onChange={(e) =\u003e updateRGB({ blue: +e.target.value })}\n      /\u003e\n    \u003c/section\u003e\n  );\n};\n\nexport default HexToRGB;\n```\n","slug":"Passing-dispatch-as-a-prop","title":"Passing Dispatch as a Prop","section":"Reducers","icon":"recycle","filePath":"/home/runner/work/React-with-TypeScript/React-with-TypeScript/lessons/06-Reducers/B-Passing-dispatch-as-a-prop.md","nextSlug":"/React-with-TypeScript/lessons/Reducers/Typing-action-and-reducers","prevSlug":"/React-with-TypeScript/lessons/Reducers/working-with-reducers"}},"__N_SSG":true},"page":"/lessons/[section]/[slug]","query":{"section":"Reducers","slug":"Passing-dispatch-as-a-prop"},"buildId":"PALjGKd3AshwdXjsrKNVy","assetPrefix":"/React-with-TypeScript","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>