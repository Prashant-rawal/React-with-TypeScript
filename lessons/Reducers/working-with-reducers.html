<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/React-with-TypeScript/images/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/React-with-TypeScript/images/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/React-with-TypeScript/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="16x16" href="/React-with-TypeScript/images/favicon-16x16.png"/><link rel="icon" type="image/x-icon" href="/React-with-TypeScript/images/favicon.ico"/><title>Working with Reducers ‚Äì React with TypeScript</title><meta name="description" content="A workshop for start using TypeScript with React"/><meta name="keywords" content="React,react,TypeScript,workshop,Prashant Rawal"/><meta name="og:description" content="A workshop for start using TypeScript with React"/><meta name="og:title" content="Working with Reducers ‚Äì React with TypeScript"/><meta name="og:image" content="/React-with-TypeScript/images/social-share-cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="next-head-count" content="14"/><link data-next-font="size-adjust" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/React-with-TypeScript/_next/static/css/b0d5392bbfae9df4.css" as="style"/><link rel="stylesheet" href="/React-with-TypeScript/_next/static/css/b0d5392bbfae9df4.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/React-with-TypeScript/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/React-with-TypeScript/_next/static/chunks/webpack-1a3481fa144e7432.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/framework-305cb810cde7afac.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/main-f3c3a156ab1ad8c6.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/pages/_app-c7df7ff57dad61ea.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/pages/lessons/%5Bsection%5D/%5Bslug%5D-9ab3041fb81318ea.js" defer=""></script><script src="/React-with-TypeScript/_next/static/PALjGKd3AshwdXjsrKNVy/_buildManifest.js" defer=""></script><script src="/React-with-TypeScript/_next/static/PALjGKd3AshwdXjsrKNVy/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="remix-app"><header class="navbar"><h1 class="navbar-brand"><a href="/React-with-TypeScript">React with TypeScript</a></h1><div class="navbar-info"></div></header><div class="content-container"><div class="main"><div class="lesson-container"><div class="lesson"><div class="lesson-content"><h1 id="typing-reducers"><strong>Typing Reducers</strong></h1>
<br>

<p>Let&#39;s head back over to our Accident Counter example</p>
<p>We&#39;ve see how to use TypeScript with <code>useState</code>, but what about <code>useReducer</code>? It shouldn&#39;t be surprisng to find that a <em>lot</em> of it works out of the box, that said, there are still some additional features that we can take advantage of the make our lives easier.</p>
<h2 id="refactoring-from-usestate-to-usereducer">Refactoring from <code>useState</code> to <code>useReducer</code></h2>
<p>There are a few ways that we could do this:</p>
<ul>
<li>Just create a super simple reducer that recieves a number and updates it accordingly. This is <em>super similar</em> to what we&#39;re doing with <code>useState</code>.</li>
<li>Create and dispatch actions like we typically see when using <code>useReducer</code>.</li>
</ul>
<p>Since the goal it so get a deep understanding of how TypeScript works with React, let&#39;s try both, although you&#39;ll probably typically do the latter.</p>
<h2 id="the-simplest-reducer">The simplest reducer</h2>
<p>This will <em>technically</em> do the trick.</p>
<pre><code class="language-tsx">const reducer = (count: number, newValue: number) =&gt; {
  return newValue;
};

const [count, setCount] = useReducer(reducer, 0);
</code></pre>
<p>There are a bunch of ways this could go wrong. What happens if we don&#39;t pass our new <code>setCount</code> a value? What if we don&#39;t give <code>useReducer</code> a default value? These are all reasonable converns that TypeScript has as well. Luckily, it will automatically protect us from writing code that hits either of the afformentioned oversights.</p>
<p><img src="_attachments/Pasted%20image%2020221107091146.png" alt="">
<img src="_attachments/Pasted%20image%2020221107091217.png" alt=""></p>
<p>Okay, enough of that. Let&#39;s write a real reducer.</p>
<h2 id="managing-the-current-and-draft-count-with-the-same-reducer">Managing the current and draft count with the same reducer</h2>
<p>Let&#39;s talk about what happens when we don&#39;t take advantage of TypeScript in this situation. Shall we? I didn&#39;t even do this on purpose, but I wrote up a super simple implementation to get us ready for this section.</p>
<p>Here was my <code>reducer</code>:</p>
<pre><code class="language-ts">type InitialState = {
  count: number;
  draftCount: string | number;
};

const initialState: InitialState = {
  count: 0,
  draftCount: 0,
};

const reducer = (state = initialState, action: any) =&gt; {
  const { count, draftCount } = state;

  if (action.type === &quot;increment&quot;) {
    const newCount = count + 1;
    return { count: newCount, draftCount: newCount };
  }

  if (action.type === &quot;decrement&quot;) {
    const newCount = count - 1;
    return { count: newCount, draftCount: newCount };
  }

  if (action.type === &quot;reset&quot;) {
    return { count: 0, draftCount: 0 };
  }

  if (action.type === &quot;updateDraftCount&quot;) {
    console.log(&quot;updateDraftCount&quot;);

    return { count, draftCount: action.payload };
  }

  if (action.type === &quot;updateCountFromDraft&quot;) {
    return { count: Number(draftCount), draftCount };
  }

  return state;
};
</code></pre>
<p>In the component itself, I wrote the following:</p>
<pre><code class="language-tsx">const Counter = () =&gt; {
  const [{ count, draftCount }, dispatch] = useReducer(reducer, initialState);

  return (
    &lt;section className=&quot;flex flex-col items-center w-2/3 gap-8 p-8 bg-white border-4 shadow-lg border-primary-500&quot;&gt;
      &lt;h1&gt;Days Since the Last Accident&lt;/h1&gt;
      &lt;p className=&quot;text-6xl&quot;&gt;{count}&lt;/p&gt;
      &lt;div className=&quot;flex gap-2&quot;&gt;
        &lt;button onClick={() =&gt; dispatch({ type: &quot;decrement&quot; })}&gt;
          ‚ûñ Decrement
        &lt;/button&gt;
        &lt;button onClick={() =&gt; dispatch({ type: &quot;reset&quot; })}&gt;üîÅ Reset&lt;/button&gt;
        &lt;button onClick={() =&gt; dispatch({ type: &quot;increment&quot; })}&gt;
          ‚ûï Increment
        &lt;/button&gt;
      &lt;/div&gt;
      &lt;div&gt;
        &lt;form
          onSubmit={(e) =&gt; {
            e.preventDefault();
            dispatch({ type: &quot;updateCountFromDraft&quot; });
          }}
        &gt;
          &lt;input
            type=&quot;number&quot;
            value={draftCount}
            onChange={(e) =&gt;
              dispatch({ action: &quot;updateDraftCount&quot;, payload: e.target.value })
            }
          /&gt;
          &lt;button type=&quot;submit&quot;&gt;Update Counter&lt;/button&gt;
        &lt;/form&gt;
      &lt;/div&gt;
    &lt;/section&gt;
  );
};
</code></pre>
<h3 id="enumerating-my-mistakes-and-other-issues">Enumerating my mistakes and other issues</h3>
<p>To be clear, I was intentionally doing this the hard way to make a point‚Äîit just turns out that I did an even better job of making my point than expected.</p>
<p><img src="_attachments/Pasted%20image%2020221107100445.png" alt=""></p>
<ul>
<li>Updating the draft count doesn&#39;t work because I made a typo. I called the property <code>action</code> instead of</li>
<li><code>count</code> is a number, but <code>draftCount</code> turned into <code>any</code>.<ul>
<li>This is because <code>action</code> is any and the <code>draftCount</code> value comes into contact with my <code>action</code> and thereby get&#39;s infected with its <code>any</code>.</li>
</ul>
</li>
</ul>
<p>There are other things that <em>could</em> have gone wrong. For example, I spent a few minutes and a bunch of <code>console.log</code>s checking to see if I had mispelled one of the action names‚Äîbecause, that&#39;s absolutely happened to me before.</p>
<p>It&#39;s kind of wild to see how one <code>any</code> could so wildly throw away all of the hard work we&#39;ve done up to this point.</p>
<h2 id="refactoring-our-reducer">Refactoring our reducer</h2>
<p>The name of the game is getting ready of that pesky <code>any</code> and then reaping all of the rewards for our hard work.</p>
<p>If an action is not <code>any</code> then what is it? Redux insists that action is an object and has a <code>type</code> property. As you saw with the simple example earlier, React&#39;s <code>useReducer</code> doesn&#39;t even care about that. It let us dispatch a number. But, let&#39;s set some ground rules and say we&#39;re going to follow something similar to <a href="https://github.com/redux-utilities/flux-standard-action">Flux Standard Actions</a>.</p>
<p>We&#39;ll say that at the very least, actions conform to this psuedocode interface:</p>
<pre><code class="language-ts">interface Action {
  type: string;
  payload?: unknown;
}
</code></pre>
<p>Don&#39;t let that <code>unknown</code> scare you. This is just an example that we&#39;re not going to use. We&#39;ll bring this idea into reality in a bit, but let&#39;s solve the problem at hand first.</p>
<p>(If you <em>really</em> want to know what I would do. You can peek at <a href="https://www.typescriptlang.org/play?#code/C4TwDgpgBAggxsAlgewHYB4AqUIA9gSoAmAzlCcAE6KoDmANFAApQC8UqEAbhJQHxsoAbwBQUKKEgAuKJgDcIgL5QAZFAAUAbSYBdHPkKkomzj0o6xUAPzDFlmaPFOoYAIYgANsldEZTBc6KAJQKIpLQAMLIAK6oBJQAysCuBIKOUHAxcTKo0QC2AEa8AVBElK4AZsBRscAyFNR0UAA+HPlFlAqKoeFQNXG88EhogkMoGJYA5DRwlBB5hMCTLVCTRBCz84vLrZNzJBBLK5PRYEQpEP3AAGKUyHkAIuVVkyJ8Cr0AqmcXT5XVWXiYxG7GBGBOPwIfyqV0mjFyhV4KwaNFo7xEIkyqAoUBmMiugwQ4zSEnAEBk01QmwWcWW3UxaBxp3OBBk3xZEGhANqhOGqDSlnCFOZv2e3Np9Esbk83l8UAALJL6QzscAoHMiNE4Ej2OpLBQLvjAbwkhdJeJXES0EaeZQwSt2aL-gS7VbUJKgmwBOkPIdhBlAYwys7AVBlOwDQRQuISAB3RDAOAACw0lr5ADpwp70uI4K4DqsZnMaUspJZnJlaoJK3EoABqKAARhKzjmwGilH5QgDtRkNeAQbFVz7ofpFfz0DWG2L2zLzlzofY-agAFomy2nG2O12e9ldwPSkPASOq2OnHmC3sIAdS+XN4dt-7+zIAAyDkO9qAvsMbi+TkVQketSTHO85bp2T6BoeH57mm4zptKXg+D+d5-qsAGXICtz3FyIF3uI4E7s+UAAHLtLw6jBjCgJBO+1GniUdj0kAA">this</a>.)</p>
<p>Let&#39;s let this reducer know about what kind of actions it can expect. If we look, it&#39;s handling the following:</p>
<ul>
<li><code>increment</code></li>
<li><code>decrement</code></li>
<li><code>reset</code></li>
<li><code>updateDraftCount</code> (This one has a payload with the new value.)</li>
<li><code>updateCountFromDraft</code></li>
</ul>
<p>Let&#39;s start by taking care of all of the actions that don&#39;t take a payload first. One of the problems with the fictitious interface that I defined above is that we don&#39;t really avoid the problem of mistyping a type.</p>
<p>In JavaScript, we often see people use constants to get around this. If you misspell a string, the code still compiles; if you mispell a constant, everything blows up. That&#39;s one way to roll your own type safety, I suppose.</p>
<pre><code class="language-js">const INCREMENT = &quot;increment&quot;;
const DECREMENT = &quot;decrement&quot;;
</code></pre>
<p>I&#39;ve always hated this. Next thing you know, you&#39;re importing these constants all over the place. It&#39;s just a mess.</p>
<p>Instead, let&#39;s try this:</p>
<pre><code class="language-ts">interface CounterAction {
  type: &quot;increment&quot; | &quot;decrement&quot; | &quot;reset&quot; | &quot;updateCountFromDraft&quot;;
}
</code></pre>
<p>We&#39;re now saying that an action can&#39;t just have <em>any</em> strings. It has to have one of the types that we know about. In a similar fashion, we can tell TypeScript about <code>updateDraftCount</code> and what kind of payload it&#39;s expecting.</p>
<pre><code class="language-ts">interface UpdateDraftCounterAction {
  type: &quot;updateDraftCount&quot;;
  payload: number | string;
}
</code></pre>
<h3 id="updating-our-reducer-with-the-new-action-type">Updating our reducer with the new action type</h3>
<p>Let&#39;s get rid of that insipid <code>any</code> and replace it with our new types:</p>
<pre><code class="language-ts">const reducer = (
  state = initialState,
  action: CounterAction | UpdateDraftCounterAction
) =&gt; {
  // ‚Ä¶
};
</code></pre>
<p>If you look closely, you can see that TypeScript saved me the trouble of logging to the console and immediate saw the error of my ways.</p>
<p><img src="_attachments/Pasted%20image%2020221107103834.png" alt=""></p>
<h3 id="taking-advantage-of-the-benefits">Taking advantage of the benefits</h3>
<p>It gets even better, because now we have autocomplete for anything involving this reducer and its actions.</p>
<p>Let&#39;s imagine that I started with this approach and began to write my reducer with the type already defined.</p>
<p><img src="_attachments/Pasted%20image%2020221107104045.png" alt=""></p>
<p>There are two things to notice here:</p>
<ol>
<li>We get autocomplete.</li>
<li><code>increment</code> is <em>not</em> included in that list.</li>
</ol>
<p><code>increment</code> is not included because we already handled that case above. As you add additional cases, the list will get shorter and shorted.</p>
<h3 id="usage-with-switch-statements">Usage with <code>switch</code> statements</h3>
<p>As a matter of preference, I don&#39;t care for <code>switch</code> statements. But, there is something interesting to notice in the screenshort below.</p>
<p><img src="_attachments/Pasted%20image%2020221107104717.png" alt=""></p>
<p>You&#39;ll notice that <code>return state</code> is faded and TypeScript knows that we&#39;ll never reach that code because we&#39;ve handled all of the possible cases an <code>action.type</code> can be. It also doesn&#39;t insist we have a <code>default</code> case for the same reason.</p>
<p>It will also help us as we use these actions in our components.</p>
<p><img src="_attachments/Pasted%20image%2020221107104916.png" alt=""></p>
<p>Additionally, if the action type expects a payload, TypeScript will ensure we don&#39;t forget about it.</p>
<p><img src="_attachments/Pasted%20image%2020221107105035.png" alt=""></p>
<h2 id="conclusion">Conclusion</h2>
<p>Using TypeScript does add <em>some</em> additional work, but it also reduces‚Äîor maybe even‚Äîelimates the need for patters such as assigning action types to constants and action creators.</p>
<p>You&#39;ll also noticed that I took care of coercing the potential string to a number in the reducer and I no longer need that <code>useEffect</code> that I apologized for in a previous section.</p>
</div><div class="lesson-links"><a href="/React-with-TypeScript/lessons/hooks/unions-in-typescript" class="prev">‚Üê Previous</a><a href="/React-with-TypeScript/lessons/Reducers/Passing-dispatch-as-a-prop" class="next">Next ‚Üí</a></div></div><div class="details-bg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="154" height="154" viewBox="0 0 154 154"><defs><clipPath id="clip-path"><rect id="Rectangle_2238" data-name="Rectangle 2238" width="154" height="154" transform="translate(9467 350)" fill="#fff" stroke="#707070" stroke-width="1"></rect></clipPath><clipPath id="clip-corner-image-active"><rect width="154" height="154"></rect></clipPath></defs><g id="corner-image-active" clip-path="url(#clip-corner-image-active)"><g id="Corner-image-active-2" data-name="Corner-image-active" transform="translate(-9467 -350)" clip-path="url(#clip-path)"><path id="Subtraction_34" data-name="Subtraction 34" d="M-3857.365,1740.766h0l-7.07-7.07,12.89-12.89v14.142l-5.818,5.818Zm-14.142-14.142h0l-7.071-7.07,27.033-27.033v14.143l-19.96,19.96Zm-14.143-14.143h0l-7.07-7.069,41.175-41.175v14.142Zm-14.142-14.142h0l-7.07-7.069,55.317-55.317v14.142Zm-14.142-14.142h0l-7.07-7.069,69.459-69.459v14.142Zm-14.142-14.142h0l-7.07-7.069,76.739-76.739h6.862v7.28Zm-14.143-14.143h0l-7.07-7.069,62.6-62.6h14.142Zm-14.142-14.142h0l-7.07-7.069,48.454-48.454h14.142Zm-14.142-14.142h0l-7.07-7.069,34.312-34.312h14.142Zm-14.142-14.142h0l-7.07-7.069,20.17-20.17h14.142Zm-14.142-14.142h0l-7.071-7.071,6.027-6.027h14.144l-13.1,13.1Zm367.24-56.114v-.909l.455.455-.453.453Z" transform="translate(13472.546 -1236.766)" fill="var(--corner-fill)"></path></g></g></svg></div></div></div></div><footer class="footer"><ul class="socials"><li class="social"><a href="https://github.com/https://github.com/IAmCuriousDeveloper"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-github-social"><rect width="32" height="32"></rect></clipPath></defs><g id="github-social" clip-path="url(#clip-github-social)"><g id="Group_272" data-name="Group 272" transform="translate(13522.5 -6994)"><path id="Subtraction_33" data-name="Subtraction 33" d="M-24967.5,8041a15.9,15.9,0,0,1-11.312-4.688A15.893,15.893,0,0,1-24983.5,8025a15.893,15.893,0,0,1,4.689-11.315A15.894,15.894,0,0,1-24967.5,8009a15.894,15.894,0,0,1,11.313,4.686A15.893,15.893,0,0,1-24951.5,8025a15.893,15.893,0,0,1-4.689,11.313A15.9,15.9,0,0,1-24967.5,8041Zm-3.781-4.571h0v3.918h7.895v-6.665a1.836,1.836,0,0,0-1.2-1.718c5.1-.617,7.467-2.975,7.467-7.424a7.176,7.176,0,0,0-1.637-4.728,6.74,6.74,0,0,0,.275-1.812,4.34,4.34,0,0,0-.52-2.452.574.574,0,0,0-.359-.1c-1.061,0-3.465,1.411-3.936,1.694a16.644,16.644,0,0,0-4.2-.489,16.379,16.379,0,0,0-3.969.445c-.846-.5-2.91-1.649-3.859-1.649a.566.566,0,0,0-.354.095,4.3,4.3,0,0,0-.521,2.452,6.7,6.7,0,0,0,.244,1.718,7.346,7.346,0,0,0-1.6,4.822,7.263,7.263,0,0,0,1.533,4.985c1.193,1.359,3.115,2.165,5.871,2.464a1.826,1.826,0,0,0-1.129,1.693v.5h0l-.006,0a7.121,7.121,0,0,1-2.033.363,2.608,2.608,0,0,1-.965-.158,4.438,4.438,0,0,1-1.836-1.881,2.361,2.361,0,0,0-1.248-1.091,3.472,3.472,0,0,0-1.217-.3.584.584,0,0,0-.545.224.282.282,0,0,0,.027.367,1.875,1.875,0,0,0,.447.307,4.732,4.732,0,0,1,.561.355,10.726,10.726,0,0,1,1.682,2.755c.043.092.078.163.105.217a3.876,3.876,0,0,0,2.42,1.185,6.036,6.036,0,0,0,.607.025c.875,0,1.988-.124,2-.125Z" transform="translate(11461 -1015)" fill="var(--footer-icons)"></path><g id="Ellipse_670" data-name="Ellipse 670" transform="translate(-13522.5 6994)" fill="none" stroke="var(--footer-icons)" stroke-width="1"><circle cx="16" cy="16" r="16" stroke="none"></circle><circle cx="16" cy="16" r="15.5" fill="none"></circle></g></g></g></svg></a></li><li class="social"><a href="https://linkedin.com/in/https://in.linkedin.com/in/prashant-rawal-12142b117"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-linkedin-social"><rect width="32" height="32"></rect></clipPath></defs><g id="linkedin-social" clip-path="url(#clip-linkedin-social)"><g id="Group_270" data-name="Group 270" transform="translate(-86.349 -633.073)"><path id="Path_375" data-name="Path 375" d="M115.789,633.073a2.324,2.324,0,0,1,1.682.676,2.194,2.194,0,0,1,.695,1.627V662.8a2.131,2.131,0,0,1-.695,1.609,2.314,2.314,0,0,1-1.646.659H88.69a2.307,2.307,0,0,1-1.646-.659,2.128,2.128,0,0,1-.695-1.609V635.376a2.19,2.19,0,0,1,.695-1.627,2.322,2.322,0,0,1,1.682-.676h27.063Zm-20.224,9.672a2.561,2.561,0,0,0,0-3.584,2.658,2.658,0,0,0-1.938-.712,2.724,2.724,0,0,0-1.957.712,2.371,2.371,0,0,0-.75,1.792,2.4,2.4,0,0,0,.731,1.792,2.605,2.605,0,0,0,1.9.713h.037A2.7,2.7,0,0,0,95.565,642.745ZM96,645.434H91.213V659.88H96Zm17.3,6.144a7.007,7.007,0,0,0-1.573-4.9,5.68,5.68,0,0,0-6.839-.769,5.663,5.663,0,0,0-1.426,1.573v-2.048H98.674q.036.841,0,7.717v6.728h4.791V651.8a3.592,3.592,0,0,1,.146-1.17,2.913,2.913,0,0,1,.878-1.206,2.429,2.429,0,0,1,1.609-.549,2.108,2.108,0,0,1,1.865.914,4.265,4.265,0,0,1,.549,2.341v7.752H113.3Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><div class="terms"><p>Content Licensed Under CC-BY-NC-4.0</p><p>Code Samples and Excercises Licensed Under Apache 2.0</p><p>Site Designed by<!-- --> <a href="https://in.linkedin.com/in/prashant-rawal-12142b117">Prashant Rawal</a></p><p>Please respect the creator</p></div></li></ul></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"attributes":{},"html":"\u003ch1 id=\"typing-reducers\"\u003e\u003cstrong\u003eTyping Reducers\u003c/strong\u003e\u003c/h1\u003e\n\u003cbr\u003e\n\n\u003cp\u003eLet\u0026#39;s head back over to our Accident Counter example\u003c/p\u003e\n\u003cp\u003eWe\u0026#39;ve see how to use TypeScript with \u003ccode\u003euseState\u003c/code\u003e, but what about \u003ccode\u003euseReducer\u003c/code\u003e? It shouldn\u0026#39;t be surprisng to find that a \u003cem\u003elot\u003c/em\u003e of it works out of the box, that said, there are still some additional features that we can take advantage of the make our lives easier.\u003c/p\u003e\n\u003ch2 id=\"refactoring-from-usestate-to-usereducer\"\u003eRefactoring from \u003ccode\u003euseState\u003c/code\u003e to \u003ccode\u003euseReducer\u003c/code\u003e\u003c/h2\u003e\n\u003cp\u003eThere are a few ways that we could do this:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eJust create a super simple reducer that recieves a number and updates it accordingly. This is \u003cem\u003esuper similar\u003c/em\u003e to what we\u0026#39;re doing with \u003ccode\u003euseState\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eCreate and dispatch actions like we typically see when using \u003ccode\u003euseReducer\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSince the goal it so get a deep understanding of how TypeScript works with React, let\u0026#39;s try both, although you\u0026#39;ll probably typically do the latter.\u003c/p\u003e\n\u003ch2 id=\"the-simplest-reducer\"\u003eThe simplest reducer\u003c/h2\u003e\n\u003cp\u003eThis will \u003cem\u003etechnically\u003c/em\u003e do the trick.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-tsx\"\u003econst reducer = (count: number, newValue: number) =\u0026gt; {\n  return newValue;\n};\n\nconst [count, setCount] = useReducer(reducer, 0);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThere are a bunch of ways this could go wrong. What happens if we don\u0026#39;t pass our new \u003ccode\u003esetCount\u003c/code\u003e a value? What if we don\u0026#39;t give \u003ccode\u003euseReducer\u003c/code\u003e a default value? These are all reasonable converns that TypeScript has as well. Luckily, it will automatically protect us from writing code that hits either of the afformentioned oversights.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"_attachments/Pasted%20image%2020221107091146.png\" alt=\"\"\u003e\n\u003cimg src=\"_attachments/Pasted%20image%2020221107091217.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eOkay, enough of that. Let\u0026#39;s write a real reducer.\u003c/p\u003e\n\u003ch2 id=\"managing-the-current-and-draft-count-with-the-same-reducer\"\u003eManaging the current and draft count with the same reducer\u003c/h2\u003e\n\u003cp\u003eLet\u0026#39;s talk about what happens when we don\u0026#39;t take advantage of TypeScript in this situation. Shall we? I didn\u0026#39;t even do this on purpose, but I wrote up a super simple implementation to get us ready for this section.\u003c/p\u003e\n\u003cp\u003eHere was my \u003ccode\u003ereducer\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ts\"\u003etype InitialState = {\n  count: number;\n  draftCount: string | number;\n};\n\nconst initialState: InitialState = {\n  count: 0,\n  draftCount: 0,\n};\n\nconst reducer = (state = initialState, action: any) =\u0026gt; {\n  const { count, draftCount } = state;\n\n  if (action.type === \u0026quot;increment\u0026quot;) {\n    const newCount = count + 1;\n    return { count: newCount, draftCount: newCount };\n  }\n\n  if (action.type === \u0026quot;decrement\u0026quot;) {\n    const newCount = count - 1;\n    return { count: newCount, draftCount: newCount };\n  }\n\n  if (action.type === \u0026quot;reset\u0026quot;) {\n    return { count: 0, draftCount: 0 };\n  }\n\n  if (action.type === \u0026quot;updateDraftCount\u0026quot;) {\n    console.log(\u0026quot;updateDraftCount\u0026quot;);\n\n    return { count, draftCount: action.payload };\n  }\n\n  if (action.type === \u0026quot;updateCountFromDraft\u0026quot;) {\n    return { count: Number(draftCount), draftCount };\n  }\n\n  return state;\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn the component itself, I wrote the following:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-tsx\"\u003econst Counter = () =\u0026gt; {\n  const [{ count, draftCount }, dispatch] = useReducer(reducer, initialState);\n\n  return (\n    \u0026lt;section className=\u0026quot;flex flex-col items-center w-2/3 gap-8 p-8 bg-white border-4 shadow-lg border-primary-500\u0026quot;\u0026gt;\n      \u0026lt;h1\u0026gt;Days Since the Last Accident\u0026lt;/h1\u0026gt;\n      \u0026lt;p className=\u0026quot;text-6xl\u0026quot;\u0026gt;{count}\u0026lt;/p\u0026gt;\n      \u0026lt;div className=\u0026quot;flex gap-2\u0026quot;\u0026gt;\n        \u0026lt;button onClick={() =\u0026gt; dispatch({ type: \u0026quot;decrement\u0026quot; })}\u0026gt;\n          ‚ûñ Decrement\n        \u0026lt;/button\u0026gt;\n        \u0026lt;button onClick={() =\u0026gt; dispatch({ type: \u0026quot;reset\u0026quot; })}\u0026gt;üîÅ Reset\u0026lt;/button\u0026gt;\n        \u0026lt;button onClick={() =\u0026gt; dispatch({ type: \u0026quot;increment\u0026quot; })}\u0026gt;\n          ‚ûï Increment\n        \u0026lt;/button\u0026gt;\n      \u0026lt;/div\u0026gt;\n      \u0026lt;div\u0026gt;\n        \u0026lt;form\n          onSubmit={(e) =\u0026gt; {\n            e.preventDefault();\n            dispatch({ type: \u0026quot;updateCountFromDraft\u0026quot; });\n          }}\n        \u0026gt;\n          \u0026lt;input\n            type=\u0026quot;number\u0026quot;\n            value={draftCount}\n            onChange={(e) =\u0026gt;\n              dispatch({ action: \u0026quot;updateDraftCount\u0026quot;, payload: e.target.value })\n            }\n          /\u0026gt;\n          \u0026lt;button type=\u0026quot;submit\u0026quot;\u0026gt;Update Counter\u0026lt;/button\u0026gt;\n        \u0026lt;/form\u0026gt;\n      \u0026lt;/div\u0026gt;\n    \u0026lt;/section\u0026gt;\n  );\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"enumerating-my-mistakes-and-other-issues\"\u003eEnumerating my mistakes and other issues\u003c/h3\u003e\n\u003cp\u003eTo be clear, I was intentionally doing this the hard way to make a point‚Äîit just turns out that I did an even better job of making my point than expected.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"_attachments/Pasted%20image%2020221107100445.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUpdating the draft count doesn\u0026#39;t work because I made a typo. I called the property \u003ccode\u003eaction\u003c/code\u003e instead of\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ecount\u003c/code\u003e is a number, but \u003ccode\u003edraftCount\u003c/code\u003e turned into \u003ccode\u003eany\u003c/code\u003e.\u003cul\u003e\n\u003cli\u003eThis is because \u003ccode\u003eaction\u003c/code\u003e is any and the \u003ccode\u003edraftCount\u003c/code\u003e value comes into contact with my \u003ccode\u003eaction\u003c/code\u003e and thereby get\u0026#39;s infected with its \u003ccode\u003eany\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThere are other things that \u003cem\u003ecould\u003c/em\u003e have gone wrong. For example, I spent a few minutes and a bunch of \u003ccode\u003econsole.log\u003c/code\u003es checking to see if I had mispelled one of the action names‚Äîbecause, that\u0026#39;s absolutely happened to me before.\u003c/p\u003e\n\u003cp\u003eIt\u0026#39;s kind of wild to see how one \u003ccode\u003eany\u003c/code\u003e could so wildly throw away all of the hard work we\u0026#39;ve done up to this point.\u003c/p\u003e\n\u003ch2 id=\"refactoring-our-reducer\"\u003eRefactoring our reducer\u003c/h2\u003e\n\u003cp\u003eThe name of the game is getting ready of that pesky \u003ccode\u003eany\u003c/code\u003e and then reaping all of the rewards for our hard work.\u003c/p\u003e\n\u003cp\u003eIf an action is not \u003ccode\u003eany\u003c/code\u003e then what is it? Redux insists that action is an object and has a \u003ccode\u003etype\u003c/code\u003e property. As you saw with the simple example earlier, React\u0026#39;s \u003ccode\u003euseReducer\u003c/code\u003e doesn\u0026#39;t even care about that. It let us dispatch a number. But, let\u0026#39;s set some ground rules and say we\u0026#39;re going to follow something similar to \u003ca href=\"https://github.com/redux-utilities/flux-standard-action\"\u003eFlux Standard Actions\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eWe\u0026#39;ll say that at the very least, actions conform to this psuedocode interface:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ts\"\u003einterface Action {\n  type: string;\n  payload?: unknown;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eDon\u0026#39;t let that \u003ccode\u003eunknown\u003c/code\u003e scare you. This is just an example that we\u0026#39;re not going to use. We\u0026#39;ll bring this idea into reality in a bit, but let\u0026#39;s solve the problem at hand first.\u003c/p\u003e\n\u003cp\u003e(If you \u003cem\u003ereally\u003c/em\u003e want to know what I would do. You can peek at \u003ca href=\"https://www.typescriptlang.org/play?#code/C4TwDgpgBAggxsAlgewHYB4AqUIA9gSoAmAzlCcAE6KoDmANFAApQC8UqEAbhJQHxsoAbwBQUKKEgAuKJgDcIgL5QAZFAAUAbSYBdHPkKkomzj0o6xUAPzDFlmaPFOoYAIYgANsldEZTBc6KAJQKIpLQAMLIAK6oBJQAysCuBIKOUHAxcTKo0QC2AEa8AVBElK4AZsBRscAyFNR0UAA+HPlFlAqKoeFQNXG88EhogkMoGJYA5DRwlBB5hMCTLVCTRBCz84vLrZNzJBBLK5PRYEQpEP3AAGKUyHkAIuVVkyJ8Cr0AqmcXT5XVWXiYxG7GBGBOPwIfyqV0mjFyhV4KwaNFo7xEIkyqAoUBmMiugwQ4zSEnAEBk01QmwWcWW3UxaBxp3OBBk3xZEGhANqhOGqDSlnCFOZv2e3Np9Esbk83l8UAALJL6QzscAoHMiNE4Ej2OpLBQLvjAbwkhdJeJXES0EaeZQwSt2aL-gS7VbUJKgmwBOkPIdhBlAYwys7AVBlOwDQRQuISAB3RDAOAACw0lr5ADpwp70uI4K4DqsZnMaUspJZnJlaoJK3EoABqKAARhKzjmwGilH5QgDtRkNeAQbFVz7ofpFfz0DWG2L2zLzlzofY-agAFomy2nG2O12e9ldwPSkPASOq2OnHmC3sIAdS+XN4dt-7+zIAAyDkO9qAvsMbi+TkVQketSTHO85bp2T6BoeH57mm4zptKXg+D+d5-qsAGXICtz3FyIF3uI4E7s+UAAHLtLw6jBjCgJBO+1GniUdj0kAA\"\u003ethis\u003c/a\u003e.)\u003c/p\u003e\n\u003cp\u003eLet\u0026#39;s let this reducer know about what kind of actions it can expect. If we look, it\u0026#39;s handling the following:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eincrement\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edecrement\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ereset\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eupdateDraftCount\u003c/code\u003e (This one has a payload with the new value.)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eupdateCountFromDraft\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eLet\u0026#39;s start by taking care of all of the actions that don\u0026#39;t take a payload first. One of the problems with the fictitious interface that I defined above is that we don\u0026#39;t really avoid the problem of mistyping a type.\u003c/p\u003e\n\u003cp\u003eIn JavaScript, we often see people use constants to get around this. If you misspell a string, the code still compiles; if you mispell a constant, everything blows up. That\u0026#39;s one way to roll your own type safety, I suppose.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-js\"\u003econst INCREMENT = \u0026quot;increment\u0026quot;;\nconst DECREMENT = \u0026quot;decrement\u0026quot;;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI\u0026#39;ve always hated this. Next thing you know, you\u0026#39;re importing these constants all over the place. It\u0026#39;s just a mess.\u003c/p\u003e\n\u003cp\u003eInstead, let\u0026#39;s try this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ts\"\u003einterface CounterAction {\n  type: \u0026quot;increment\u0026quot; | \u0026quot;decrement\u0026quot; | \u0026quot;reset\u0026quot; | \u0026quot;updateCountFromDraft\u0026quot;;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe\u0026#39;re now saying that an action can\u0026#39;t just have \u003cem\u003eany\u003c/em\u003e strings. It has to have one of the types that we know about. In a similar fashion, we can tell TypeScript about \u003ccode\u003eupdateDraftCount\u003c/code\u003e and what kind of payload it\u0026#39;s expecting.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ts\"\u003einterface UpdateDraftCounterAction {\n  type: \u0026quot;updateDraftCount\u0026quot;;\n  payload: number | string;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"updating-our-reducer-with-the-new-action-type\"\u003eUpdating our reducer with the new action type\u003c/h3\u003e\n\u003cp\u003eLet\u0026#39;s get rid of that insipid \u003ccode\u003eany\u003c/code\u003e and replace it with our new types:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ts\"\u003econst reducer = (\n  state = initialState,\n  action: CounterAction | UpdateDraftCounterAction\n) =\u0026gt; {\n  // ‚Ä¶\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIf you look closely, you can see that TypeScript saved me the trouble of logging to the console and immediate saw the error of my ways.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"_attachments/Pasted%20image%2020221107103834.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch3 id=\"taking-advantage-of-the-benefits\"\u003eTaking advantage of the benefits\u003c/h3\u003e\n\u003cp\u003eIt gets even better, because now we have autocomplete for anything involving this reducer and its actions.\u003c/p\u003e\n\u003cp\u003eLet\u0026#39;s imagine that I started with this approach and began to write my reducer with the type already defined.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"_attachments/Pasted%20image%2020221107104045.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eThere are two things to notice here:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eWe get autocomplete.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eincrement\u003c/code\u003e is \u003cem\u003enot\u003c/em\u003e included in that list.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ccode\u003eincrement\u003c/code\u003e is not included because we already handled that case above. As you add additional cases, the list will get shorter and shorted.\u003c/p\u003e\n\u003ch3 id=\"usage-with-switch-statements\"\u003eUsage with \u003ccode\u003eswitch\u003c/code\u003e statements\u003c/h3\u003e\n\u003cp\u003eAs a matter of preference, I don\u0026#39;t care for \u003ccode\u003eswitch\u003c/code\u003e statements. But, there is something interesting to notice in the screenshort below.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"_attachments/Pasted%20image%2020221107104717.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eYou\u0026#39;ll notice that \u003ccode\u003ereturn state\u003c/code\u003e is faded and TypeScript knows that we\u0026#39;ll never reach that code because we\u0026#39;ve handled all of the possible cases an \u003ccode\u003eaction.type\u003c/code\u003e can be. It also doesn\u0026#39;t insist we have a \u003ccode\u003edefault\u003c/code\u003e case for the same reason.\u003c/p\u003e\n\u003cp\u003eIt will also help us as we use these actions in our components.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"_attachments/Pasted%20image%2020221107104916.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eAdditionally, if the action type expects a payload, TypeScript will ensure we don\u0026#39;t forget about it.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"_attachments/Pasted%20image%2020221107105035.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch2 id=\"conclusion\"\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eUsing TypeScript does add \u003cem\u003esome\u003c/em\u003e additional work, but it also reduces‚Äîor maybe even‚Äîelimates the need for patters such as assigning action types to constants and action creators.\u003c/p\u003e\n\u003cp\u003eYou\u0026#39;ll also noticed that I took care of coercing the potential string to a number in the reducer and I no longer need that \u003ccode\u003euseEffect\u003c/code\u003e that I apologized for in a previous section.\u003c/p\u003e\n","markdown":"# **Typing Reducers**\n\n\u003cbr\u003e\n\nLet's head back over to our Accident Counter example\n\nWe've see how to use TypeScript with `useState`, but what about `useReducer`? It shouldn't be surprisng to find that a _lot_ of it works out of the box, that said, there are still some additional features that we can take advantage of the make our lives easier.\n\n## Refactoring from `useState` to `useReducer`\n\nThere are a few ways that we could do this:\n\n- Just create a super simple reducer that recieves a number and updates it accordingly. This is _super similar_ to what we're doing with `useState`.\n- Create and dispatch actions like we typically see when using `useReducer`.\n\nSince the goal it so get a deep understanding of how TypeScript works with React, let's try both, although you'll probably typically do the latter.\n\n## The simplest reducer\n\nThis will _technically_ do the trick.\n\n```tsx\nconst reducer = (count: number, newValue: number) =\u003e {\n  return newValue;\n};\n\nconst [count, setCount] = useReducer(reducer, 0);\n```\n\nThere are a bunch of ways this could go wrong. What happens if we don't pass our new `setCount` a value? What if we don't give `useReducer` a default value? These are all reasonable converns that TypeScript has as well. Luckily, it will automatically protect us from writing code that hits either of the afformentioned oversights.\n\n![](_attachments/Pasted%20image%2020221107091146.png)\n![](_attachments/Pasted%20image%2020221107091217.png)\n\nOkay, enough of that. Let's write a real reducer.\n\n## Managing the current and draft count with the same reducer\n\nLet's talk about what happens when we don't take advantage of TypeScript in this situation. Shall we? I didn't even do this on purpose, but I wrote up a super simple implementation to get us ready for this section.\n\nHere was my `reducer`:\n\n```ts\ntype InitialState = {\n  count: number;\n  draftCount: string | number;\n};\n\nconst initialState: InitialState = {\n  count: 0,\n  draftCount: 0,\n};\n\nconst reducer = (state = initialState, action: any) =\u003e {\n  const { count, draftCount } = state;\n\n  if (action.type === \"increment\") {\n    const newCount = count + 1;\n    return { count: newCount, draftCount: newCount };\n  }\n\n  if (action.type === \"decrement\") {\n    const newCount = count - 1;\n    return { count: newCount, draftCount: newCount };\n  }\n\n  if (action.type === \"reset\") {\n    return { count: 0, draftCount: 0 };\n  }\n\n  if (action.type === \"updateDraftCount\") {\n    console.log(\"updateDraftCount\");\n\n    return { count, draftCount: action.payload };\n  }\n\n  if (action.type === \"updateCountFromDraft\") {\n    return { count: Number(draftCount), draftCount };\n  }\n\n  return state;\n};\n```\n\nIn the component itself, I wrote the following:\n\n```tsx\nconst Counter = () =\u003e {\n  const [{ count, draftCount }, dispatch] = useReducer(reducer, initialState);\n\n  return (\n    \u003csection className=\"flex flex-col items-center w-2/3 gap-8 p-8 bg-white border-4 shadow-lg border-primary-500\"\u003e\n      \u003ch1\u003eDays Since the Last Accident\u003c/h1\u003e\n      \u003cp className=\"text-6xl\"\u003e{count}\u003c/p\u003e\n      \u003cdiv className=\"flex gap-2\"\u003e\n        \u003cbutton onClick={() =\u003e dispatch({ type: \"decrement\" })}\u003e\n          ‚ûñ Decrement\n        \u003c/button\u003e\n        \u003cbutton onClick={() =\u003e dispatch({ type: \"reset\" })}\u003eüîÅ Reset\u003c/button\u003e\n        \u003cbutton onClick={() =\u003e dispatch({ type: \"increment\" })}\u003e\n          ‚ûï Increment\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv\u003e\n        \u003cform\n          onSubmit={(e) =\u003e {\n            e.preventDefault();\n            dispatch({ type: \"updateCountFromDraft\" });\n          }}\n        \u003e\n          \u003cinput\n            type=\"number\"\n            value={draftCount}\n            onChange={(e) =\u003e\n              dispatch({ action: \"updateDraftCount\", payload: e.target.value })\n            }\n          /\u003e\n          \u003cbutton type=\"submit\"\u003eUpdate Counter\u003c/button\u003e\n        \u003c/form\u003e\n      \u003c/div\u003e\n    \u003c/section\u003e\n  );\n};\n```\n\n### Enumerating my mistakes and other issues\n\nTo be clear, I was intentionally doing this the hard way to make a point‚Äîit just turns out that I did an even better job of making my point than expected.\n\n![](_attachments/Pasted%20image%2020221107100445.png)\n\n- Updating the draft count doesn't work because I made a typo. I called the property `action` instead of\n- `count` is a number, but `draftCount` turned into `any`.\n  - This is because `action` is any and the `draftCount` value comes into contact with my `action` and thereby get's infected with its `any`.\n\nThere are other things that _could_ have gone wrong. For example, I spent a few minutes and a bunch of `console.log`s checking to see if I had mispelled one of the action names‚Äîbecause, that's absolutely happened to me before.\n\nIt's kind of wild to see how one `any` could so wildly throw away all of the hard work we've done up to this point.\n\n## Refactoring our reducer\n\nThe name of the game is getting ready of that pesky `any` and then reaping all of the rewards for our hard work.\n\nIf an action is not `any` then what is it? Redux insists that action is an object and has a `type` property. As you saw with the simple example earlier, React's `useReducer` doesn't even care about that. It let us dispatch a number. But, let's set some ground rules and say we're going to follow something similar to [Flux Standard Actions](https://github.com/redux-utilities/flux-standard-action).\n\nWe'll say that at the very least, actions conform to this psuedocode interface:\n\n```ts\ninterface Action {\n  type: string;\n  payload?: unknown;\n}\n```\n\nDon't let that `unknown` scare you. This is just an example that we're not going to use. We'll bring this idea into reality in a bit, but let's solve the problem at hand first.\n\n(If you _really_ want to know what I would do. You can peek at [this](https://www.typescriptlang.org/play?#code/C4TwDgpgBAggxsAlgewHYB4AqUIA9gSoAmAzlCcAE6KoDmANFAApQC8UqEAbhJQHxsoAbwBQUKKEgAuKJgDcIgL5QAZFAAUAbSYBdHPkKkomzj0o6xUAPzDFlmaPFOoYAIYgANsldEZTBc6KAJQKIpLQAMLIAK6oBJQAysCuBIKOUHAxcTKo0QC2AEa8AVBElK4AZsBRscAyFNR0UAA+HPlFlAqKoeFQNXG88EhogkMoGJYA5DRwlBB5hMCTLVCTRBCz84vLrZNzJBBLK5PRYEQpEP3AAGKUyHkAIuVVkyJ8Cr0AqmcXT5XVWXiYxG7GBGBOPwIfyqV0mjFyhV4KwaNFo7xEIkyqAoUBmMiugwQ4zSEnAEBk01QmwWcWW3UxaBxp3OBBk3xZEGhANqhOGqDSlnCFOZv2e3Np9Esbk83l8UAALJL6QzscAoHMiNE4Ej2OpLBQLvjAbwkhdJeJXES0EaeZQwSt2aL-gS7VbUJKgmwBOkPIdhBlAYwys7AVBlOwDQRQuISAB3RDAOAACw0lr5ADpwp70uI4K4DqsZnMaUspJZnJlaoJK3EoABqKAARhKzjmwGilH5QgDtRkNeAQbFVz7ofpFfz0DWG2L2zLzlzofY-agAFomy2nG2O12e9ldwPSkPASOq2OnHmC3sIAdS+XN4dt-7+zIAAyDkO9qAvsMbi+TkVQketSTHO85bp2T6BoeH57mm4zptKXg+D+d5-qsAGXICtz3FyIF3uI4E7s+UAAHLtLw6jBjCgJBO+1GniUdj0kAA).)\n\nLet's let this reducer know about what kind of actions it can expect. If we look, it's handling the following:\n\n- `increment`\n- `decrement`\n- `reset`\n- `updateDraftCount` (This one has a payload with the new value.)\n- `updateCountFromDraft`\n\nLet's start by taking care of all of the actions that don't take a payload first. One of the problems with the fictitious interface that I defined above is that we don't really avoid the problem of mistyping a type.\n\nIn JavaScript, we often see people use constants to get around this. If you misspell a string, the code still compiles; if you mispell a constant, everything blows up. That's one way to roll your own type safety, I suppose.\n\n```js\nconst INCREMENT = \"increment\";\nconst DECREMENT = \"decrement\";\n```\n\nI've always hated this. Next thing you know, you're importing these constants all over the place. It's just a mess.\n\nInstead, let's try this:\n\n```ts\ninterface CounterAction {\n  type: \"increment\" | \"decrement\" | \"reset\" | \"updateCountFromDraft\";\n}\n```\n\nWe're now saying that an action can't just have _any_ strings. It has to have one of the types that we know about. In a similar fashion, we can tell TypeScript about `updateDraftCount` and what kind of payload it's expecting.\n\n```ts\ninterface UpdateDraftCounterAction {\n  type: \"updateDraftCount\";\n  payload: number | string;\n}\n```\n\n### Updating our reducer with the new action type\n\nLet's get rid of that insipid `any` and replace it with our new types:\n\n```ts\nconst reducer = (\n  state = initialState,\n  action: CounterAction | UpdateDraftCounterAction\n) =\u003e {\n  // ‚Ä¶\n};\n```\n\nIf you look closely, you can see that TypeScript saved me the trouble of logging to the console and immediate saw the error of my ways.\n\n![](_attachments/Pasted%20image%2020221107103834.png)\n\n### Taking advantage of the benefits\n\nIt gets even better, because now we have autocomplete for anything involving this reducer and its actions.\n\nLet's imagine that I started with this approach and began to write my reducer with the type already defined.\n\n![](_attachments/Pasted%20image%2020221107104045.png)\n\nThere are two things to notice here:\n\n1. We get autocomplete.\n1. `increment` is _not_ included in that list.\n\n`increment` is not included because we already handled that case above. As you add additional cases, the list will get shorter and shorted.\n\n### Usage with `switch` statements\n\nAs a matter of preference, I don't care for `switch` statements. But, there is something interesting to notice in the screenshort below.\n\n![](_attachments/Pasted%20image%2020221107104717.png)\n\nYou'll notice that `return state` is faded and TypeScript knows that we'll never reach that code because we've handled all of the possible cases an `action.type` can be. It also doesn't insist we have a `default` case for the same reason.\n\nIt will also help us as we use these actions in our components.\n\n![](_attachments/Pasted%20image%2020221107104916.png)\n\nAdditionally, if the action type expects a payload, TypeScript will ensure we don't forget about it.\n\n![](_attachments/Pasted%20image%2020221107105035.png)\n\n## Conclusion\n\nUsing TypeScript does add _some_ additional work, but it also reduces‚Äîor maybe even‚Äîelimates the need for patters such as assigning action types to constants and action creators.\n\nYou'll also noticed that I took care of coercing the potential string to a number in the reducer and I no longer need that `useEffect` that I apologized for in a previous section.\n","slug":"working-with-reducers","title":"Working with Reducers","section":"Reducers","icon":"recycle","filePath":"/home/runner/work/React-with-TypeScript/React-with-TypeScript/lessons/06-Reducers/A-working-with-reducers.md","nextSlug":"/React-with-TypeScript/lessons/Reducers/Passing-dispatch-as-a-prop","prevSlug":"/React-with-TypeScript/lessons/hooks/unions-in-typescript"}},"__N_SSG":true},"page":"/lessons/[section]/[slug]","query":{"section":"Reducers","slug":"working-with-reducers"},"buildId":"PALjGKd3AshwdXjsrKNVy","assetPrefix":"/React-with-TypeScript","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>