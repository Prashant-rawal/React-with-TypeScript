<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/React-with-TypeScript/images/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/React-with-TypeScript/images/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/React-with-TypeScript/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="16x16" href="/React-with-TypeScript/images/favicon-16x16.png"/><link rel="icon" type="image/x-icon" href="/React-with-TypeScript/images/favicon.ico"/><title>useState Solution – React with TypeScript</title><meta name="description" content="A workshop for start using TypeScript with React"/><meta name="keywords" content="React,react,TypeScript,workshop,Prashant Rawal"/><meta name="og:description" content="A workshop for start using TypeScript with React"/><meta name="og:title" content="useState Solution – React with TypeScript"/><meta name="og:image" content="/React-with-TypeScript/images/social-share-cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="next-head-count" content="14"/><link data-next-font="size-adjust" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/React-with-TypeScript/_next/static/css/b0d5392bbfae9df4.css" as="style"/><link rel="stylesheet" href="/React-with-TypeScript/_next/static/css/b0d5392bbfae9df4.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/React-with-TypeScript/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/React-with-TypeScript/_next/static/chunks/webpack-1a3481fa144e7432.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/framework-305cb810cde7afac.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/main-f3c3a156ab1ad8c6.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/pages/_app-c7df7ff57dad61ea.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/pages/lessons/%5Bsection%5D/%5Bslug%5D-9ab3041fb81318ea.js" defer=""></script><script src="/React-with-TypeScript/_next/static/PALjGKd3AshwdXjsrKNVy/_buildManifest.js" defer=""></script><script src="/React-with-TypeScript/_next/static/PALjGKd3AshwdXjsrKNVy/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="remix-app"><header class="navbar"><h1 class="navbar-brand"><a href="/React-with-TypeScript">React with TypeScript</a></h1><div class="navbar-info"></div></header><div class="content-container"><div class="main"><div class="lesson-container"><div class="lesson"><div class="lesson-content"><h1 id="usestate-exercise"><strong>UseState Exercise</strong></h1>
<br>

<p>We&#39;ll start by creating some state to hold on to the value in the input field. I&#39;m going to base it on whatever the current count was when the component was first rendered, but you don&#39;t have to.</p>
<pre><code class="language-tsx">const [draftCount, setDraftCount] = useState(count);
</code></pre>
<p>I can <em>try</em> to add that as a change handler to the <code>&lt;input /&gt;</code>, but I already alluded to the fact that this isn&#39;t going to go particularly well.</p>
<p>My annoyance with this behavior of the DOM may or may not become a recurring theme today.</p>
<p>This is similar to what we saw before. The message reads:</p>
<blockquote>
<p>Argument of type <code>string</code> is not assignable to parameter of type <code>SetStateAction&lt;number&gt;</code>.</p>
</blockquote>
<p>The solution is straight-forward here. We need to coerce that value to a number. Choose your poison. You can use <code>parseInt</code>, <code>Number()</code>, or the <code>+</code> unary.</p>
<pre><code class="language-ts">setDraftCount(+e.target.value);
setDraftCount(parseInt(e.target.value));
setDraftCount(Number(e.target.value));
</code></pre>
<p>Now, we just update the <em>real</em> count to the draft count when we submit the form.</p>
<pre><code class="language-ts">&lt;form
  onSubmit={(e) =&gt; {
    e.preventDefault();
    setCount(draftCount);
  }}
&gt;
  // …
&lt;/form&gt;
</code></pre>
<p>You&#39;ll see that this almost works. That input field is hard to clear out. An empty string coerces to zero. This isn&#39;t TypeScript&#39;s fault per se, but it&#39;s an issue that we&#39;ve run into because TypeScript is keeping us honest and making it harder to play fast and loose.</p>
<p>We have a few options:</p>
<ul>
<li>We can store the draft state and convert it to a number when it&#39;s time to set the count. This is easy and we should totally do it.</li>
<li>Even better: we can let <code>draftCount</code> be either a string or a number and then do that first bullet point.</li>
</ul>
<p>This <em>seems</em> tedious, but I will remind you that it&#39;s actually correct probably what we should be doing regardless.</p>
<p>If we default it to a string, it&#39;s now a string.</p>
<pre><code class="language-ts">const [draftCount, setDraftCount] = useState(&quot;0&quot;);
</code></pre>
<p>The reason I don&#39;t love this is because I have to think about it if I want it to default to whatever the count is. Like, if I wanted to use a side effect to update the draft count in the input field whenever they hit the &quot;Increment&quot; or &quot;Decrement&quot; buttons, I&#39;m burdened with coercing it back into a string.</p>
<p>This is particularly annoying because input fields don&#39;t care. Just look at it&#39;s type.</p>
<pre><code class="language-ts">React.InputHTMLAttributes&lt;HTMLInputElement&gt;.value?: string | number | readonly string[] | undefined
</code></pre>
<p>Amongst other things, it takes a <code>string | number</code>. We&#39;ll deal with that in a moment. Let&#39;s coerce that string into a number for the count, which totally needs to be a number before we forget.</p>
<pre><code class="language-tsx">&lt;form
  onSubmit={(e) =&gt; {
    e.preventDefault();
    setCount(Number(draftCount));
  }}
&gt;
  // …
&lt;/form&gt;
</code></pre>
<p>We were taking advantage of TypeScript automatically figuring stuff out on our behalf, but the code we wrote is <em>really</em> just similar to this:</p>
<pre><code class="language-ts">const [count, setCount] = useState&lt;number&gt;(0);
const [draftCount, setDraftCount] = useState&lt;string&gt;(&quot;0&quot;);
</code></pre>
<p>We can take things into our own hands and update our draft state to support being either a string or a number.</p>
<pre><code class="language-ts">const [draftCount, setDraftCount] = useState&lt;string | number&gt;(0);
</code></pre>
<p>Now, everyhing works as expected.</p>
<h2 id="extension-updating-the-draft-count">Extension: updating the draft count</h2>
<p>Just to make this all worth it, we can add that little extra feature we were talking about where the input field is updated to whatever the current count is.</p>
<pre><code class="language-js">useEffect(() =&gt; {
  setDraftCount(count);
}, [count]);
</code></pre>
<p>Look ma, no typing. Everything just works. Here is a fun fact that you can impress people at parties, there is an alternative take on this that <em>will</em> upset TypeScript.</p>
<!-- ```ts
// Reset the counter after a certain amount of time
useEffect(() => setTimeout(setCount(0), 31536000000));
```

The error message reads:

> Type `Timeout` is not assignable to type `void | Destructor`.

`useEffect` expects the function you hand it to return either nothing or a function that it should call when the component is unmounting. There is code inside of React to defensively protect you from giving it something else. We've probably all written code like this before:

```ts
if (typeof fn === "function") fn();
```

But, TypeScript's job is to try to reduce this burden on us. So, it's not even going to let you do that to React. Luckily, this fix is simple. Add back those curly braces to the function so that it doesn't automatically return a value.

```ts
// Reset the counter after a certain amount of time
useEffect(() => {
  setTimeout(setCount(0), 31536000000);
});
```

We didn't run into that problem with `setDraftCount` because `setDraftCount` returns `void` (e.g. `undefined`) anyway. -->

<h3 id="a-quick-disclaimer">A quick disclaimer</h3>
<p>React experts will know that using <code>useEffect</code> isn&#39;t great here because it could trigger a second render. One alternative is to just wrap <code>setCount</code> to do both at the same time. This is probably the best example, but I&#39;m most just trying to drum up fictitious reasons to show you the <code>useEffect</code> hook with TypeScript and it seemed more efficient to do it here than to set us up in a brand new example.</p>
</div><div class="lesson-links"><a href="/React-with-TypeScript/lessons/hooks/useState-exercise" class="prev">← Previous</a><a href="/React-with-TypeScript/lessons/hooks/setting-State-without-default-value" class="next">Next →</a></div></div><div class="details-bg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="154" height="154" viewBox="0 0 154 154"><defs><clipPath id="clip-path"><rect id="Rectangle_2238" data-name="Rectangle 2238" width="154" height="154" transform="translate(9467 350)" fill="#fff" stroke="#707070" stroke-width="1"></rect></clipPath><clipPath id="clip-corner-image-active"><rect width="154" height="154"></rect></clipPath></defs><g id="corner-image-active" clip-path="url(#clip-corner-image-active)"><g id="Corner-image-active-2" data-name="Corner-image-active" transform="translate(-9467 -350)" clip-path="url(#clip-path)"><path id="Subtraction_34" data-name="Subtraction 34" d="M-3857.365,1740.766h0l-7.07-7.07,12.89-12.89v14.142l-5.818,5.818Zm-14.142-14.142h0l-7.071-7.07,27.033-27.033v14.143l-19.96,19.96Zm-14.143-14.143h0l-7.07-7.069,41.175-41.175v14.142Zm-14.142-14.142h0l-7.07-7.069,55.317-55.317v14.142Zm-14.142-14.142h0l-7.07-7.069,69.459-69.459v14.142Zm-14.142-14.142h0l-7.07-7.069,76.739-76.739h6.862v7.28Zm-14.143-14.143h0l-7.07-7.069,62.6-62.6h14.142Zm-14.142-14.142h0l-7.07-7.069,48.454-48.454h14.142Zm-14.142-14.142h0l-7.07-7.069,34.312-34.312h14.142Zm-14.142-14.142h0l-7.07-7.069,20.17-20.17h14.142Zm-14.142-14.142h0l-7.071-7.071,6.027-6.027h14.144l-13.1,13.1Zm367.24-56.114v-.909l.455.455-.453.453Z" transform="translate(13472.546 -1236.766)" fill="var(--corner-fill)"></path></g></g></svg></div></div></div></div><footer class="footer"><ul class="socials"><li class="social"><a href="https://github.com/https://github.com/IAmCuriousDeveloper"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-github-social"><rect width="32" height="32"></rect></clipPath></defs><g id="github-social" clip-path="url(#clip-github-social)"><g id="Group_272" data-name="Group 272" transform="translate(13522.5 -6994)"><path id="Subtraction_33" data-name="Subtraction 33" d="M-24967.5,8041a15.9,15.9,0,0,1-11.312-4.688A15.893,15.893,0,0,1-24983.5,8025a15.893,15.893,0,0,1,4.689-11.315A15.894,15.894,0,0,1-24967.5,8009a15.894,15.894,0,0,1,11.313,4.686A15.893,15.893,0,0,1-24951.5,8025a15.893,15.893,0,0,1-4.689,11.313A15.9,15.9,0,0,1-24967.5,8041Zm-3.781-4.571h0v3.918h7.895v-6.665a1.836,1.836,0,0,0-1.2-1.718c5.1-.617,7.467-2.975,7.467-7.424a7.176,7.176,0,0,0-1.637-4.728,6.74,6.74,0,0,0,.275-1.812,4.34,4.34,0,0,0-.52-2.452.574.574,0,0,0-.359-.1c-1.061,0-3.465,1.411-3.936,1.694a16.644,16.644,0,0,0-4.2-.489,16.379,16.379,0,0,0-3.969.445c-.846-.5-2.91-1.649-3.859-1.649a.566.566,0,0,0-.354.095,4.3,4.3,0,0,0-.521,2.452,6.7,6.7,0,0,0,.244,1.718,7.346,7.346,0,0,0-1.6,4.822,7.263,7.263,0,0,0,1.533,4.985c1.193,1.359,3.115,2.165,5.871,2.464a1.826,1.826,0,0,0-1.129,1.693v.5h0l-.006,0a7.121,7.121,0,0,1-2.033.363,2.608,2.608,0,0,1-.965-.158,4.438,4.438,0,0,1-1.836-1.881,2.361,2.361,0,0,0-1.248-1.091,3.472,3.472,0,0,0-1.217-.3.584.584,0,0,0-.545.224.282.282,0,0,0,.027.367,1.875,1.875,0,0,0,.447.307,4.732,4.732,0,0,1,.561.355,10.726,10.726,0,0,1,1.682,2.755c.043.092.078.163.105.217a3.876,3.876,0,0,0,2.42,1.185,6.036,6.036,0,0,0,.607.025c.875,0,1.988-.124,2-.125Z" transform="translate(11461 -1015)" fill="var(--footer-icons)"></path><g id="Ellipse_670" data-name="Ellipse 670" transform="translate(-13522.5 6994)" fill="none" stroke="var(--footer-icons)" stroke-width="1"><circle cx="16" cy="16" r="16" stroke="none"></circle><circle cx="16" cy="16" r="15.5" fill="none"></circle></g></g></g></svg></a></li><li class="social"><a href="https://linkedin.com/in/https://in.linkedin.com/in/prashant-rawal-12142b117"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-linkedin-social"><rect width="32" height="32"></rect></clipPath></defs><g id="linkedin-social" clip-path="url(#clip-linkedin-social)"><g id="Group_270" data-name="Group 270" transform="translate(-86.349 -633.073)"><path id="Path_375" data-name="Path 375" d="M115.789,633.073a2.324,2.324,0,0,1,1.682.676,2.194,2.194,0,0,1,.695,1.627V662.8a2.131,2.131,0,0,1-.695,1.609,2.314,2.314,0,0,1-1.646.659H88.69a2.307,2.307,0,0,1-1.646-.659,2.128,2.128,0,0,1-.695-1.609V635.376a2.19,2.19,0,0,1,.695-1.627,2.322,2.322,0,0,1,1.682-.676h27.063Zm-20.224,9.672a2.561,2.561,0,0,0,0-3.584,2.658,2.658,0,0,0-1.938-.712,2.724,2.724,0,0,0-1.957.712,2.371,2.371,0,0,0-.75,1.792,2.4,2.4,0,0,0,.731,1.792,2.605,2.605,0,0,0,1.9.713h.037A2.7,2.7,0,0,0,95.565,642.745ZM96,645.434H91.213V659.88H96Zm17.3,6.144a7.007,7.007,0,0,0-1.573-4.9,5.68,5.68,0,0,0-6.839-.769,5.663,5.663,0,0,0-1.426,1.573v-2.048H98.674q.036.841,0,7.717v6.728h4.791V651.8a3.592,3.592,0,0,1,.146-1.17,2.913,2.913,0,0,1,.878-1.206,2.429,2.429,0,0,1,1.609-.549,2.108,2.108,0,0,1,1.865.914,4.265,4.265,0,0,1,.549,2.341v7.752H113.3Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><div class="terms"><p>Content Licensed Under CC-BY-NC-4.0</p><p>Code Samples and Excercises Licensed Under Apache 2.0</p><p>Site Designed by<!-- --> <a href="https://in.linkedin.com/in/prashant-rawal-12142b117">Prashant Rawal</a></p><p>Please respect the creator</p></div></li></ul></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"attributes":{},"html":"\u003ch1 id=\"usestate-exercise\"\u003e\u003cstrong\u003eUseState Exercise\u003c/strong\u003e\u003c/h1\u003e\n\u003cbr\u003e\n\n\u003cp\u003eWe\u0026#39;ll start by creating some state to hold on to the value in the input field. I\u0026#39;m going to base it on whatever the current count was when the component was first rendered, but you don\u0026#39;t have to.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-tsx\"\u003econst [draftCount, setDraftCount] = useState(count);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI can \u003cem\u003etry\u003c/em\u003e to add that as a change handler to the \u003ccode\u003e\u0026lt;input /\u0026gt;\u003c/code\u003e, but I already alluded to the fact that this isn\u0026#39;t going to go particularly well.\u003c/p\u003e\n\u003cp\u003eMy annoyance with this behavior of the DOM may or may not become a recurring theme today.\u003c/p\u003e\n\u003cp\u003eThis is similar to what we saw before. The message reads:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eArgument of type \u003ccode\u003estring\u003c/code\u003e is not assignable to parameter of type \u003ccode\u003eSetStateAction\u0026lt;number\u0026gt;\u003c/code\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eThe solution is straight-forward here. We need to coerce that value to a number. Choose your poison. You can use \u003ccode\u003eparseInt\u003c/code\u003e, \u003ccode\u003eNumber()\u003c/code\u003e, or the \u003ccode\u003e+\u003c/code\u003e unary.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ts\"\u003esetDraftCount(+e.target.value);\nsetDraftCount(parseInt(e.target.value));\nsetDraftCount(Number(e.target.value));\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow, we just update the \u003cem\u003ereal\u003c/em\u003e count to the draft count when we submit the form.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ts\"\u003e\u0026lt;form\n  onSubmit={(e) =\u0026gt; {\n    e.preventDefault();\n    setCount(draftCount);\n  }}\n\u0026gt;\n  // …\n\u0026lt;/form\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou\u0026#39;ll see that this almost works. That input field is hard to clear out. An empty string coerces to zero. This isn\u0026#39;t TypeScript\u0026#39;s fault per se, but it\u0026#39;s an issue that we\u0026#39;ve run into because TypeScript is keeping us honest and making it harder to play fast and loose.\u003c/p\u003e\n\u003cp\u003eWe have a few options:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWe can store the draft state and convert it to a number when it\u0026#39;s time to set the count. This is easy and we should totally do it.\u003c/li\u003e\n\u003cli\u003eEven better: we can let \u003ccode\u003edraftCount\u003c/code\u003e be either a string or a number and then do that first bullet point.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThis \u003cem\u003eseems\u003c/em\u003e tedious, but I will remind you that it\u0026#39;s actually correct probably what we should be doing regardless.\u003c/p\u003e\n\u003cp\u003eIf we default it to a string, it\u0026#39;s now a string.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ts\"\u003econst [draftCount, setDraftCount] = useState(\u0026quot;0\u0026quot;);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe reason I don\u0026#39;t love this is because I have to think about it if I want it to default to whatever the count is. Like, if I wanted to use a side effect to update the draft count in the input field whenever they hit the \u0026quot;Increment\u0026quot; or \u0026quot;Decrement\u0026quot; buttons, I\u0026#39;m burdened with coercing it back into a string.\u003c/p\u003e\n\u003cp\u003eThis is particularly annoying because input fields don\u0026#39;t care. Just look at it\u0026#39;s type.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ts\"\u003eReact.InputHTMLAttributes\u0026lt;HTMLInputElement\u0026gt;.value?: string | number | readonly string[] | undefined\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAmongst other things, it takes a \u003ccode\u003estring | number\u003c/code\u003e. We\u0026#39;ll deal with that in a moment. Let\u0026#39;s coerce that string into a number for the count, which totally needs to be a number before we forget.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-tsx\"\u003e\u0026lt;form\n  onSubmit={(e) =\u0026gt; {\n    e.preventDefault();\n    setCount(Number(draftCount));\n  }}\n\u0026gt;\n  // …\n\u0026lt;/form\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe were taking advantage of TypeScript automatically figuring stuff out on our behalf, but the code we wrote is \u003cem\u003ereally\u003c/em\u003e just similar to this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ts\"\u003econst [count, setCount] = useState\u0026lt;number\u0026gt;(0);\nconst [draftCount, setDraftCount] = useState\u0026lt;string\u0026gt;(\u0026quot;0\u0026quot;);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWe can take things into our own hands and update our draft state to support being either a string or a number.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ts\"\u003econst [draftCount, setDraftCount] = useState\u0026lt;string | number\u0026gt;(0);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow, everyhing works as expected.\u003c/p\u003e\n\u003ch2 id=\"extension-updating-the-draft-count\"\u003eExtension: updating the draft count\u003c/h2\u003e\n\u003cp\u003eJust to make this all worth it, we can add that little extra feature we were talking about where the input field is updated to whatever the current count is.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-js\"\u003euseEffect(() =\u0026gt; {\n  setDraftCount(count);\n}, [count]);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eLook ma, no typing. Everything just works. Here is a fun fact that you can impress people at parties, there is an alternative take on this that \u003cem\u003ewill\u003c/em\u003e upset TypeScript.\u003c/p\u003e\n\u003c!-- ```ts\n// Reset the counter after a certain amount of time\nuseEffect(() =\u003e setTimeout(setCount(0), 31536000000));\n```\n\nThe error message reads:\n\n\u003e Type `Timeout` is not assignable to type `void | Destructor`.\n\n`useEffect` expects the function you hand it to return either nothing or a function that it should call when the component is unmounting. There is code inside of React to defensively protect you from giving it something else. We've probably all written code like this before:\n\n```ts\nif (typeof fn === \"function\") fn();\n```\n\nBut, TypeScript's job is to try to reduce this burden on us. So, it's not even going to let you do that to React. Luckily, this fix is simple. Add back those curly braces to the function so that it doesn't automatically return a value.\n\n```ts\n// Reset the counter after a certain amount of time\nuseEffect(() =\u003e {\n  setTimeout(setCount(0), 31536000000);\n});\n```\n\nWe didn't run into that problem with `setDraftCount` because `setDraftCount` returns `void` (e.g. `undefined`) anyway. --\u003e\n\n\u003ch3 id=\"a-quick-disclaimer\"\u003eA quick disclaimer\u003c/h3\u003e\n\u003cp\u003eReact experts will know that using \u003ccode\u003euseEffect\u003c/code\u003e isn\u0026#39;t great here because it could trigger a second render. One alternative is to just wrap \u003ccode\u003esetCount\u003c/code\u003e to do both at the same time. This is probably the best example, but I\u0026#39;m most just trying to drum up fictitious reasons to show you the \u003ccode\u003euseEffect\u003c/code\u003e hook with TypeScript and it seemed more efficient to do it here than to set us up in a brand new example.\u003c/p\u003e\n","markdown":"# **UseState Exercise**\n\n\u003cbr\u003e\n\nWe'll start by creating some state to hold on to the value in the input field. I'm going to base it on whatever the current count was when the component was first rendered, but you don't have to.\n\n```tsx\nconst [draftCount, setDraftCount] = useState(count);\n```\n\nI can _try_ to add that as a change handler to the `\u003cinput /\u003e`, but I already alluded to the fact that this isn't going to go particularly well.\n\nMy annoyance with this behavior of the DOM may or may not become a recurring theme today.\n\nThis is similar to what we saw before. The message reads:\n\n\u003e Argument of type `string` is not assignable to parameter of type `SetStateAction\u003cnumber\u003e`.\n\nThe solution is straight-forward here. We need to coerce that value to a number. Choose your poison. You can use `parseInt`, `Number()`, or the `+` unary.\n\n```ts\nsetDraftCount(+e.target.value);\nsetDraftCount(parseInt(e.target.value));\nsetDraftCount(Number(e.target.value));\n```\n\nNow, we just update the _real_ count to the draft count when we submit the form.\n\n```ts\n\u003cform\n  onSubmit={(e) =\u003e {\n    e.preventDefault();\n    setCount(draftCount);\n  }}\n\u003e\n  // …\n\u003c/form\u003e\n```\n\nYou'll see that this almost works. That input field is hard to clear out. An empty string coerces to zero. This isn't TypeScript's fault per se, but it's an issue that we've run into because TypeScript is keeping us honest and making it harder to play fast and loose.\n\nWe have a few options:\n\n- We can store the draft state and convert it to a number when it's time to set the count. This is easy and we should totally do it.\n- Even better: we can let `draftCount` be either a string or a number and then do that first bullet point.\n\nThis _seems_ tedious, but I will remind you that it's actually correct probably what we should be doing regardless.\n\nIf we default it to a string, it's now a string.\n\n```ts\nconst [draftCount, setDraftCount] = useState(\"0\");\n```\n\nThe reason I don't love this is because I have to think about it if I want it to default to whatever the count is. Like, if I wanted to use a side effect to update the draft count in the input field whenever they hit the \"Increment\" or \"Decrement\" buttons, I'm burdened with coercing it back into a string.\n\nThis is particularly annoying because input fields don't care. Just look at it's type.\n\n```ts\nReact.InputHTMLAttributes\u003cHTMLInputElement\u003e.value?: string | number | readonly string[] | undefined\n```\n\nAmongst other things, it takes a `string | number`. We'll deal with that in a moment. Let's coerce that string into a number for the count, which totally needs to be a number before we forget.\n\n```tsx\n\u003cform\n  onSubmit={(e) =\u003e {\n    e.preventDefault();\n    setCount(Number(draftCount));\n  }}\n\u003e\n  // …\n\u003c/form\u003e\n```\n\nWe were taking advantage of TypeScript automatically figuring stuff out on our behalf, but the code we wrote is _really_ just similar to this:\n\n```ts\nconst [count, setCount] = useState\u003cnumber\u003e(0);\nconst [draftCount, setDraftCount] = useState\u003cstring\u003e(\"0\");\n```\n\nWe can take things into our own hands and update our draft state to support being either a string or a number.\n\n```ts\nconst [draftCount, setDraftCount] = useState\u003cstring | number\u003e(0);\n```\n\nNow, everyhing works as expected.\n\n## Extension: updating the draft count\n\nJust to make this all worth it, we can add that little extra feature we were talking about where the input field is updated to whatever the current count is.\n\n```js\nuseEffect(() =\u003e {\n  setDraftCount(count);\n}, [count]);\n```\n\nLook ma, no typing. Everything just works. Here is a fun fact that you can impress people at parties, there is an alternative take on this that _will_ upset TypeScript.\n\n\u003c!-- ```ts\n// Reset the counter after a certain amount of time\nuseEffect(() =\u003e setTimeout(setCount(0), 31536000000));\n```\n\nThe error message reads:\n\n\u003e Type `Timeout` is not assignable to type `void | Destructor`.\n\n`useEffect` expects the function you hand it to return either nothing or a function that it should call when the component is unmounting. There is code inside of React to defensively protect you from giving it something else. We've probably all written code like this before:\n\n```ts\nif (typeof fn === \"function\") fn();\n```\n\nBut, TypeScript's job is to try to reduce this burden on us. So, it's not even going to let you do that to React. Luckily, this fix is simple. Add back those curly braces to the function so that it doesn't automatically return a value.\n\n```ts\n// Reset the counter after a certain amount of time\nuseEffect(() =\u003e {\n  setTimeout(setCount(0), 31536000000);\n});\n```\n\nWe didn't run into that problem with `setDraftCount` because `setDraftCount` returns `void` (e.g. `undefined`) anyway. --\u003e\n\n### A quick disclaimer\n\nReact experts will know that using `useEffect` isn't great here because it could trigger a second render. One alternative is to just wrap `setCount` to do both at the same time. This is probably the best example, but I'm most just trying to drum up fictitious reasons to show you the `useEffect` hook with TypeScript and it seemed more efficient to do it here than to set us up in a brand new example.\n","slug":"useState-Solution","title":"useState Solution","section":"Hooks","icon":"hammer","filePath":"/home/runner/work/React-with-TypeScript/React-with-TypeScript/lessons/05-hooks/C-useState-Solution.md","nextSlug":"/React-with-TypeScript/lessons/hooks/setting-State-without-default-value","prevSlug":"/React-with-TypeScript/lessons/hooks/useState-exercise"}},"__N_SSG":true},"page":"/lessons/[section]/[slug]","query":{"section":"hooks","slug":"useState-Solution"},"buildId":"PALjGKd3AshwdXjsrKNVy","assetPrefix":"/React-with-TypeScript","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>