<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/React-with-TypeScript/images/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/React-with-TypeScript/images/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/React-with-TypeScript/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="16x16" href="/React-with-TypeScript/images/favicon-16x16.png"/><link rel="icon" type="image/x-icon" href="/React-with-TypeScript/images/favicon.ico"/><title>Context Api Solution – React with TypeScript</title><meta name="description" content="A workshop for start using TypeScript with React"/><meta name="keywords" content="React,react,TypeScript,workshop,Prashant Rawal"/><meta name="og:description" content="A workshop for start using TypeScript with React"/><meta name="og:title" content="Context Api Solution – React with TypeScript"/><meta name="og:image" content="/React-with-TypeScript/images/social-share-cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="next-head-count" content="14"/><link data-next-font="size-adjust" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/React-with-TypeScript/_next/static/css/b0d5392bbfae9df4.css" as="style"/><link rel="stylesheet" href="/React-with-TypeScript/_next/static/css/b0d5392bbfae9df4.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/React-with-TypeScript/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/React-with-TypeScript/_next/static/chunks/webpack-1a3481fa144e7432.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/framework-305cb810cde7afac.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/main-f3c3a156ab1ad8c6.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/pages/_app-c7df7ff57dad61ea.js" defer=""></script><script src="/React-with-TypeScript/_next/static/chunks/pages/lessons/%5Bsection%5D/%5Bslug%5D-9ab3041fb81318ea.js" defer=""></script><script src="/React-with-TypeScript/_next/static/PALjGKd3AshwdXjsrKNVy/_buildManifest.js" defer=""></script><script src="/React-with-TypeScript/_next/static/PALjGKd3AshwdXjsrKNVy/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="remix-app"><header class="navbar"><h1 class="navbar-brand"><a href="/React-with-TypeScript">React with TypeScript</a></h1><div class="navbar-info"></div></header><div class="content-container"><div class="main"><div class="lesson-container"><div class="lesson"><div class="lesson-content"><h1 id="solution"><strong>Solution</strong></h1>
<br>

<p>Alright, you can see I did a little bit of the basic set up for you as this is a course on TypeScript and not the Context API itself and you just watched me set up the Context API in a previous example. You&#39;re more than welcome to delete <code>src/context.tsx</code>, if you&#39;d like.</p>
<p>Let&#39;s port over our state management from <code>src/components/application.tsx</code>:</p>
<pre><code class="language-tsx">export const ItemsProvider = ({ children }: PropsWithChildren) =&gt; {
  const [items, setItems] = useState&lt;Item[]&gt;(getInitialItems());

  const add = (name: string) =&gt; {
    const item = createItem(name);
    setItems([...items, item]);
  };

  const update = (id: string, updates: any) =&gt; {
    setItems(updateItem(items, id, updates));
  };

  const remove = (id: string) =&gt; {
    setItems(removeItem(items, id));
  };

  const unpackedItems = filterItems(items, { packed: false });
  const packedItems = filterItems(items, { packed: true });

  const markAllAsUnpacked = () =&gt; {
    return setItems(items.map((item) =&gt; ({ ...item, packed: false })));
  };

  return &lt;ItemsContext.Provider value={null}&gt;{children}&lt;/ItemsContext.Provider&gt;;
};

export default ItemsProvider;
</code></pre>
<h2 id="putting-together-our-state-management-package">Putting together our state management package</h2>
<p>Let&#39;s bundle up all of those actions and lists into one nice little package.</p>
<pre><code class="language-ts">const value = {
  items,
  packedItems,
  unpackedItems,
  add,
  remove,
  update,
  markAllAsUnpacked,
};
</code></pre>
<p>Now, this time around, we chose to use <code>useState</code> instead of <code>useReducer</code>, so it&#39;s a little tricker. There are a bunch of tricks, we <em>could</em> do, but I&#39;m going to use this as excuse to remind you my favorite trick: <em>Use TypeScript to teach yourself about TypeScript.</em></p>
<p>What happens if we hover over the <code>value</code> we just made?</p>
<p><img src="_attachments/Pasted%20image%2020221114142019.png" alt=""></p>
<p>Oh, look! That seems like a reasonable type that we can use.</p>
<pre><code class="language-ts">type ItemsState = {
  items: Item[];
  packedItems: Item[];
  unpackedItems: Item[];
  add: (name: string) =&gt; void;
  remove: (id: string) =&gt; void;
  update: (id: string, updates: any) =&gt; void;
  markAllAsUnpacked: () =&gt; void;
};
</code></pre>
<h2 id="assert-the-type">Assert the type</h2>
<p>Alright, here is where we wanted to try out the strategy that I previously showed you because we told <code>ItemsContext</code> that it&#39;s value would be <code>null</code> and—clearly—that&#39;s a lie.</p>
<pre><code class="language-tsx">export const ItemsContext = createContext({} as ItemsState);
</code></pre>
<p>Don&#39;t forget actually pass in that value:</p>
<pre><code class="language-tsx">&lt;ItemsContext.Provider value={value}&gt;{children}&lt;/ItemsContext.Provider&gt;
</code></pre>
<h2 id="wiring-it-all-up">Wiring it all up</h2>
<p>Now, you can take my word that this all works or we can throw it together real fast. It&#39;s up to you.</p>
<p>The nice part is that TypeScript isn&#39;t really going to let us keep any loose ends around as we do this refactor.</p>
<p>(<strong>Note</strong>: I am <em>only</em> going to do the <code>ItemList</code> components, there isn&#39;t much of a gain in doing it to <code>NewItem</code>, <code>Header</code>, and <code>MarkAllAsUnpacked</code>.)</p>
<p>In <code>src/components/application.tsx</code>, you&#39;ll notice that sweet, sweet autocomplete as I pull properties off of the <code>ItemsContext</code>.</p>
<p>Next up, <code>ItemsList</code> doesn&#39;t need those actions at all. We&#39;ll remove them and head down to <code>Item</code>—following the compiler errors along the way.</p>
<h2 id="end-result">End Result</h2>
<p>In <code>src/components/application.tsx</code>:</p>
<pre><code class="language-diff">@@ -1,56 +1,21 @@
-import { useState } from &#39;react&#39;;
-import {
-  createItem,
-  filterItems,
-  getInitialItems,
-  removeItem,
-  updateItem,
-} from &#39;../lib/items&#39;;
+import { useContext } from &#39;react&#39;;
+import { ItemsContext } from &#39;../context&#39;;
 import Header from &#39;./header&#39;;
 import ItemList from &#39;./item-list&#39;;
 import MarkAllAsUnpacked from &#39;./mark-all-as-unpacked&#39;;
 import NewItem from &#39;./new-item&#39;;

 const Application = () =&gt; {
-  const [items, setItems] = useState(getInitialItems());
-
-  const add = (name: string) =&gt; {
-    const item = createItem(name);
-    setItems([...items, item]);
-  };
-
-  const update = (id: string, updates: any) =&gt; {
-    setItems(updateItem(items, id, updates));
-  };
-
-  const remove = (id: string) =&gt; {
-    setItems(removeItem(items, id));
-  };
-
-  const unpackedItems = filterItems(items, { packed: false });
-  const packedItems = filterItems(items, { packed: true });
-
-  const markAllAsUnpacked = () =&gt; {
-    return setItems(items.map((item) =&gt; ({ ...item, packed: false })));
-  };
+  const { items, unpackedItems, packedItems, add, markAllAsUnpacked } =
+    useContext(ItemsContext);

   return (
     &lt;main className=&quot;flex flex-col gap-8 p-8 mx-auto lg:max-w-4xl&quot;&gt;
       &lt;Header items={items} /&gt;
       &lt;NewItem addItem={add} /&gt;
       &lt;section className=&quot;flex flex-col gap-8 md:flex-row&quot;&gt;
-        &lt;ItemList
-          title=&quot;Unpacked Items&quot;
-          items={unpackedItems}
-          update={update}
-          remove={remove}
-        /&gt;
-        &lt;ItemList
-          title=&quot;Packed Items&quot;
-          items={packedItems}
-          update={update}
-          remove={remove}
-        /&gt;
+        &lt;ItemList title=&quot;Unpacked Items&quot; items={unpackedItems} /&gt;
+        &lt;ItemList title=&quot;Packed Items&quot; items={packedItems} /&gt;
       &lt;/section&gt;
       &lt;MarkAllAsUnpacked onClick={markAllAsUnpacked} /&gt;
     &lt;/main&gt;
</code></pre>
<p>In <code>src/components/item-list.tsx</code>:</p>
<pre><code class="language-diff">@@ -6,11 +6,9 @@ import Item from &#39;./item&#39;;
 type ItemsProps = {
   title: string;
   items: Item[];
-  update: (id: string, updates: any) =&gt; void;
-  remove: (id: string) =&gt; void;
 };

-const ItemList = ({ title = &#39;Items&#39;, items, update, remove }: ItemsProps) =&gt; {
+const ItemList = ({ title = &#39;Items&#39;, items }: ItemsProps) =&gt; {
   const [filter, setFilter] = useState(&#39;&#39;);
   const id = toKebabCase(title);

@@ -32,7 +30,7 @@ const ItemList = ({ title = &#39;Items&#39;, items, update, remove }: ItemsProps) =&gt; {
       &lt;/header&gt;
       &lt;ul className=&quot;flex flex-col gap-2&quot;&gt;
         {filteredItems.map((item) =&gt; (
-          &lt;Item key={item.id} item={item} update={update} remove={remove} /&gt;
+          &lt;Item key={item.id} item={item} /&gt;
         ))}
       &lt;/ul&gt;
       {isEmpty &amp;&amp; &lt;p className=&quot;text-primary-400&quot;&gt;(Nothing to show.)&lt;/p&gt;}
</code></pre>
<p>In <code>src/components/item.tsx</code>:</p>
<pre><code class="language-diff">@@ -1,14 +1,14 @@
 import clsx from &#39;clsx&#39;;
-import { useState } from &#39;react&#39;;
+import { useContext, useState } from &#39;react&#39;;
+import { ItemsContext } from &#39;../context&#39;;

 type ItemProps = {
   item: Item;
-  update: (id: string, updates: any) =&gt; void;
-  remove: (id: string) =&gt; void;
 };

-const Item = ({ item, update, remove }: ItemProps) =&gt; {
+const Item = ({ item }: ItemProps) =&gt; {
   const [editing, setEditing] = useState(false);
+  const { update, remove } = useContext(ItemsContext);

   return (
     &lt;li className=&quot;flex items-center gap-2&quot;&gt;
</code></pre>
</div><div class="lesson-links"><a href="/React-with-TypeScript/lessons/context-api/context-api-exercise" class="prev">← Previous</a></div></div><div class="details-bg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="154" height="154" viewBox="0 0 154 154"><defs><clipPath id="clip-path"><rect id="Rectangle_2238" data-name="Rectangle 2238" width="154" height="154" transform="translate(9467 350)" fill="#fff" stroke="#707070" stroke-width="1"></rect></clipPath><clipPath id="clip-corner-image-active"><rect width="154" height="154"></rect></clipPath></defs><g id="corner-image-active" clip-path="url(#clip-corner-image-active)"><g id="Corner-image-active-2" data-name="Corner-image-active" transform="translate(-9467 -350)" clip-path="url(#clip-path)"><path id="Subtraction_34" data-name="Subtraction 34" d="M-3857.365,1740.766h0l-7.07-7.07,12.89-12.89v14.142l-5.818,5.818Zm-14.142-14.142h0l-7.071-7.07,27.033-27.033v14.143l-19.96,19.96Zm-14.143-14.143h0l-7.07-7.069,41.175-41.175v14.142Zm-14.142-14.142h0l-7.07-7.069,55.317-55.317v14.142Zm-14.142-14.142h0l-7.07-7.069,69.459-69.459v14.142Zm-14.142-14.142h0l-7.07-7.069,76.739-76.739h6.862v7.28Zm-14.143-14.143h0l-7.07-7.069,62.6-62.6h14.142Zm-14.142-14.142h0l-7.07-7.069,48.454-48.454h14.142Zm-14.142-14.142h0l-7.07-7.069,34.312-34.312h14.142Zm-14.142-14.142h0l-7.07-7.069,20.17-20.17h14.142Zm-14.142-14.142h0l-7.071-7.071,6.027-6.027h14.144l-13.1,13.1Zm367.24-56.114v-.909l.455.455-.453.453Z" transform="translate(13472.546 -1236.766)" fill="var(--corner-fill)"></path></g></g></svg></div></div></div></div><footer class="footer"><ul class="socials"><li class="social"><a href="https://github.com/https://github.com/IAmCuriousDeveloper"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-github-social"><rect width="32" height="32"></rect></clipPath></defs><g id="github-social" clip-path="url(#clip-github-social)"><g id="Group_272" data-name="Group 272" transform="translate(13522.5 -6994)"><path id="Subtraction_33" data-name="Subtraction 33" d="M-24967.5,8041a15.9,15.9,0,0,1-11.312-4.688A15.893,15.893,0,0,1-24983.5,8025a15.893,15.893,0,0,1,4.689-11.315A15.894,15.894,0,0,1-24967.5,8009a15.894,15.894,0,0,1,11.313,4.686A15.893,15.893,0,0,1-24951.5,8025a15.893,15.893,0,0,1-4.689,11.313A15.9,15.9,0,0,1-24967.5,8041Zm-3.781-4.571h0v3.918h7.895v-6.665a1.836,1.836,0,0,0-1.2-1.718c5.1-.617,7.467-2.975,7.467-7.424a7.176,7.176,0,0,0-1.637-4.728,6.74,6.74,0,0,0,.275-1.812,4.34,4.34,0,0,0-.52-2.452.574.574,0,0,0-.359-.1c-1.061,0-3.465,1.411-3.936,1.694a16.644,16.644,0,0,0-4.2-.489,16.379,16.379,0,0,0-3.969.445c-.846-.5-2.91-1.649-3.859-1.649a.566.566,0,0,0-.354.095,4.3,4.3,0,0,0-.521,2.452,6.7,6.7,0,0,0,.244,1.718,7.346,7.346,0,0,0-1.6,4.822,7.263,7.263,0,0,0,1.533,4.985c1.193,1.359,3.115,2.165,5.871,2.464a1.826,1.826,0,0,0-1.129,1.693v.5h0l-.006,0a7.121,7.121,0,0,1-2.033.363,2.608,2.608,0,0,1-.965-.158,4.438,4.438,0,0,1-1.836-1.881,2.361,2.361,0,0,0-1.248-1.091,3.472,3.472,0,0,0-1.217-.3.584.584,0,0,0-.545.224.282.282,0,0,0,.027.367,1.875,1.875,0,0,0,.447.307,4.732,4.732,0,0,1,.561.355,10.726,10.726,0,0,1,1.682,2.755c.043.092.078.163.105.217a3.876,3.876,0,0,0,2.42,1.185,6.036,6.036,0,0,0,.607.025c.875,0,1.988-.124,2-.125Z" transform="translate(11461 -1015)" fill="var(--footer-icons)"></path><g id="Ellipse_670" data-name="Ellipse 670" transform="translate(-13522.5 6994)" fill="none" stroke="var(--footer-icons)" stroke-width="1"><circle cx="16" cy="16" r="16" stroke="none"></circle><circle cx="16" cy="16" r="15.5" fill="none"></circle></g></g></g></svg></a></li><li class="social"><a href="https://linkedin.com/in/https://in.linkedin.com/in/prashant-rawal-12142b117"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-linkedin-social"><rect width="32" height="32"></rect></clipPath></defs><g id="linkedin-social" clip-path="url(#clip-linkedin-social)"><g id="Group_270" data-name="Group 270" transform="translate(-86.349 -633.073)"><path id="Path_375" data-name="Path 375" d="M115.789,633.073a2.324,2.324,0,0,1,1.682.676,2.194,2.194,0,0,1,.695,1.627V662.8a2.131,2.131,0,0,1-.695,1.609,2.314,2.314,0,0,1-1.646.659H88.69a2.307,2.307,0,0,1-1.646-.659,2.128,2.128,0,0,1-.695-1.609V635.376a2.19,2.19,0,0,1,.695-1.627,2.322,2.322,0,0,1,1.682-.676h27.063Zm-20.224,9.672a2.561,2.561,0,0,0,0-3.584,2.658,2.658,0,0,0-1.938-.712,2.724,2.724,0,0,0-1.957.712,2.371,2.371,0,0,0-.75,1.792,2.4,2.4,0,0,0,.731,1.792,2.605,2.605,0,0,0,1.9.713h.037A2.7,2.7,0,0,0,95.565,642.745ZM96,645.434H91.213V659.88H96Zm17.3,6.144a7.007,7.007,0,0,0-1.573-4.9,5.68,5.68,0,0,0-6.839-.769,5.663,5.663,0,0,0-1.426,1.573v-2.048H98.674q.036.841,0,7.717v6.728h4.791V651.8a3.592,3.592,0,0,1,.146-1.17,2.913,2.913,0,0,1,.878-1.206,2.429,2.429,0,0,1,1.609-.549,2.108,2.108,0,0,1,1.865.914,4.265,4.265,0,0,1,.549,2.341v7.752H113.3Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><div class="terms"><p>Content Licensed Under CC-BY-NC-4.0</p><p>Code Samples and Excercises Licensed Under Apache 2.0</p><p>Site Designed by<!-- --> <a href="https://in.linkedin.com/in/prashant-rawal-12142b117">Prashant Rawal</a></p><p>Please respect the creator</p></div></li></ul></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"attributes":{},"html":"\u003ch1 id=\"solution\"\u003e\u003cstrong\u003eSolution\u003c/strong\u003e\u003c/h1\u003e\n\u003cbr\u003e\n\n\u003cp\u003eAlright, you can see I did a little bit of the basic set up for you as this is a course on TypeScript and not the Context API itself and you just watched me set up the Context API in a previous example. You\u0026#39;re more than welcome to delete \u003ccode\u003esrc/context.tsx\u003c/code\u003e, if you\u0026#39;d like.\u003c/p\u003e\n\u003cp\u003eLet\u0026#39;s port over our state management from \u003ccode\u003esrc/components/application.tsx\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-tsx\"\u003eexport const ItemsProvider = ({ children }: PropsWithChildren) =\u0026gt; {\n  const [items, setItems] = useState\u0026lt;Item[]\u0026gt;(getInitialItems());\n\n  const add = (name: string) =\u0026gt; {\n    const item = createItem(name);\n    setItems([...items, item]);\n  };\n\n  const update = (id: string, updates: any) =\u0026gt; {\n    setItems(updateItem(items, id, updates));\n  };\n\n  const remove = (id: string) =\u0026gt; {\n    setItems(removeItem(items, id));\n  };\n\n  const unpackedItems = filterItems(items, { packed: false });\n  const packedItems = filterItems(items, { packed: true });\n\n  const markAllAsUnpacked = () =\u0026gt; {\n    return setItems(items.map((item) =\u0026gt; ({ ...item, packed: false })));\n  };\n\n  return \u0026lt;ItemsContext.Provider value={null}\u0026gt;{children}\u0026lt;/ItemsContext.Provider\u0026gt;;\n};\n\nexport default ItemsProvider;\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"putting-together-our-state-management-package\"\u003ePutting together our state management package\u003c/h2\u003e\n\u003cp\u003eLet\u0026#39;s bundle up all of those actions and lists into one nice little package.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ts\"\u003econst value = {\n  items,\n  packedItems,\n  unpackedItems,\n  add,\n  remove,\n  update,\n  markAllAsUnpacked,\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow, this time around, we chose to use \u003ccode\u003euseState\u003c/code\u003e instead of \u003ccode\u003euseReducer\u003c/code\u003e, so it\u0026#39;s a little tricker. There are a bunch of tricks, we \u003cem\u003ecould\u003c/em\u003e do, but I\u0026#39;m going to use this as excuse to remind you my favorite trick: \u003cem\u003eUse TypeScript to teach yourself about TypeScript.\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eWhat happens if we hover over the \u003ccode\u003evalue\u003c/code\u003e we just made?\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"_attachments/Pasted%20image%2020221114142019.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003eOh, look! That seems like a reasonable type that we can use.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-ts\"\u003etype ItemsState = {\n  items: Item[];\n  packedItems: Item[];\n  unpackedItems: Item[];\n  add: (name: string) =\u0026gt; void;\n  remove: (id: string) =\u0026gt; void;\n  update: (id: string, updates: any) =\u0026gt; void;\n  markAllAsUnpacked: () =\u0026gt; void;\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"assert-the-type\"\u003eAssert the type\u003c/h2\u003e\n\u003cp\u003eAlright, here is where we wanted to try out the strategy that I previously showed you because we told \u003ccode\u003eItemsContext\u003c/code\u003e that it\u0026#39;s value would be \u003ccode\u003enull\u003c/code\u003e and—clearly—that\u0026#39;s a lie.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-tsx\"\u003eexport const ItemsContext = createContext({} as ItemsState);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eDon\u0026#39;t forget actually pass in that value:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-tsx\"\u003e\u0026lt;ItemsContext.Provider value={value}\u0026gt;{children}\u0026lt;/ItemsContext.Provider\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"wiring-it-all-up\"\u003eWiring it all up\u003c/h2\u003e\n\u003cp\u003eNow, you can take my word that this all works or we can throw it together real fast. It\u0026#39;s up to you.\u003c/p\u003e\n\u003cp\u003eThe nice part is that TypeScript isn\u0026#39;t really going to let us keep any loose ends around as we do this refactor.\u003c/p\u003e\n\u003cp\u003e(\u003cstrong\u003eNote\u003c/strong\u003e: I am \u003cem\u003eonly\u003c/em\u003e going to do the \u003ccode\u003eItemList\u003c/code\u003e components, there isn\u0026#39;t much of a gain in doing it to \u003ccode\u003eNewItem\u003c/code\u003e, \u003ccode\u003eHeader\u003c/code\u003e, and \u003ccode\u003eMarkAllAsUnpacked\u003c/code\u003e.)\u003c/p\u003e\n\u003cp\u003eIn \u003ccode\u003esrc/components/application.tsx\u003c/code\u003e, you\u0026#39;ll notice that sweet, sweet autocomplete as I pull properties off of the \u003ccode\u003eItemsContext\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eNext up, \u003ccode\u003eItemsList\u003c/code\u003e doesn\u0026#39;t need those actions at all. We\u0026#39;ll remove them and head down to \u003ccode\u003eItem\u003c/code\u003e—following the compiler errors along the way.\u003c/p\u003e\n\u003ch2 id=\"end-result\"\u003eEnd Result\u003c/h2\u003e\n\u003cp\u003eIn \u003ccode\u003esrc/components/application.tsx\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-diff\"\u003e@@ -1,56 +1,21 @@\n-import { useState } from \u0026#39;react\u0026#39;;\n-import {\n-  createItem,\n-  filterItems,\n-  getInitialItems,\n-  removeItem,\n-  updateItem,\n-} from \u0026#39;../lib/items\u0026#39;;\n+import { useContext } from \u0026#39;react\u0026#39;;\n+import { ItemsContext } from \u0026#39;../context\u0026#39;;\n import Header from \u0026#39;./header\u0026#39;;\n import ItemList from \u0026#39;./item-list\u0026#39;;\n import MarkAllAsUnpacked from \u0026#39;./mark-all-as-unpacked\u0026#39;;\n import NewItem from \u0026#39;./new-item\u0026#39;;\n\n const Application = () =\u0026gt; {\n-  const [items, setItems] = useState(getInitialItems());\n-\n-  const add = (name: string) =\u0026gt; {\n-    const item = createItem(name);\n-    setItems([...items, item]);\n-  };\n-\n-  const update = (id: string, updates: any) =\u0026gt; {\n-    setItems(updateItem(items, id, updates));\n-  };\n-\n-  const remove = (id: string) =\u0026gt; {\n-    setItems(removeItem(items, id));\n-  };\n-\n-  const unpackedItems = filterItems(items, { packed: false });\n-  const packedItems = filterItems(items, { packed: true });\n-\n-  const markAllAsUnpacked = () =\u0026gt; {\n-    return setItems(items.map((item) =\u0026gt; ({ ...item, packed: false })));\n-  };\n+  const { items, unpackedItems, packedItems, add, markAllAsUnpacked } =\n+    useContext(ItemsContext);\n\n   return (\n     \u0026lt;main className=\u0026quot;flex flex-col gap-8 p-8 mx-auto lg:max-w-4xl\u0026quot;\u0026gt;\n       \u0026lt;Header items={items} /\u0026gt;\n       \u0026lt;NewItem addItem={add} /\u0026gt;\n       \u0026lt;section className=\u0026quot;flex flex-col gap-8 md:flex-row\u0026quot;\u0026gt;\n-        \u0026lt;ItemList\n-          title=\u0026quot;Unpacked Items\u0026quot;\n-          items={unpackedItems}\n-          update={update}\n-          remove={remove}\n-        /\u0026gt;\n-        \u0026lt;ItemList\n-          title=\u0026quot;Packed Items\u0026quot;\n-          items={packedItems}\n-          update={update}\n-          remove={remove}\n-        /\u0026gt;\n+        \u0026lt;ItemList title=\u0026quot;Unpacked Items\u0026quot; items={unpackedItems} /\u0026gt;\n+        \u0026lt;ItemList title=\u0026quot;Packed Items\u0026quot; items={packedItems} /\u0026gt;\n       \u0026lt;/section\u0026gt;\n       \u0026lt;MarkAllAsUnpacked onClick={markAllAsUnpacked} /\u0026gt;\n     \u0026lt;/main\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn \u003ccode\u003esrc/components/item-list.tsx\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-diff\"\u003e@@ -6,11 +6,9 @@ import Item from \u0026#39;./item\u0026#39;;\n type ItemsProps = {\n   title: string;\n   items: Item[];\n-  update: (id: string, updates: any) =\u0026gt; void;\n-  remove: (id: string) =\u0026gt; void;\n };\n\n-const ItemList = ({ title = \u0026#39;Items\u0026#39;, items, update, remove }: ItemsProps) =\u0026gt; {\n+const ItemList = ({ title = \u0026#39;Items\u0026#39;, items }: ItemsProps) =\u0026gt; {\n   const [filter, setFilter] = useState(\u0026#39;\u0026#39;);\n   const id = toKebabCase(title);\n\n@@ -32,7 +30,7 @@ const ItemList = ({ title = \u0026#39;Items\u0026#39;, items, update, remove }: ItemsProps) =\u0026gt; {\n       \u0026lt;/header\u0026gt;\n       \u0026lt;ul className=\u0026quot;flex flex-col gap-2\u0026quot;\u0026gt;\n         {filteredItems.map((item) =\u0026gt; (\n-          \u0026lt;Item key={item.id} item={item} update={update} remove={remove} /\u0026gt;\n+          \u0026lt;Item key={item.id} item={item} /\u0026gt;\n         ))}\n       \u0026lt;/ul\u0026gt;\n       {isEmpty \u0026amp;\u0026amp; \u0026lt;p className=\u0026quot;text-primary-400\u0026quot;\u0026gt;(Nothing to show.)\u0026lt;/p\u0026gt;}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn \u003ccode\u003esrc/components/item.tsx\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-diff\"\u003e@@ -1,14 +1,14 @@\n import clsx from \u0026#39;clsx\u0026#39;;\n-import { useState } from \u0026#39;react\u0026#39;;\n+import { useContext, useState } from \u0026#39;react\u0026#39;;\n+import { ItemsContext } from \u0026#39;../context\u0026#39;;\n\n type ItemProps = {\n   item: Item;\n-  update: (id: string, updates: any) =\u0026gt; void;\n-  remove: (id: string) =\u0026gt; void;\n };\n\n-const Item = ({ item, update, remove }: ItemProps) =\u0026gt; {\n+const Item = ({ item }: ItemProps) =\u0026gt; {\n   const [editing, setEditing] = useState(false);\n+  const { update, remove } = useContext(ItemsContext);\n\n   return (\n     \u0026lt;li className=\u0026quot;flex items-center gap-2\u0026quot;\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\n","markdown":"# **Solution**\n\n\u003cbr\u003e\n\nAlright, you can see I did a little bit of the basic set up for you as this is a course on TypeScript and not the Context API itself and you just watched me set up the Context API in a previous example. You're more than welcome to delete `src/context.tsx`, if you'd like.\n\nLet's port over our state management from `src/components/application.tsx`:\n\n```tsx\nexport const ItemsProvider = ({ children }: PropsWithChildren) =\u003e {\n  const [items, setItems] = useState\u003cItem[]\u003e(getInitialItems());\n\n  const add = (name: string) =\u003e {\n    const item = createItem(name);\n    setItems([...items, item]);\n  };\n\n  const update = (id: string, updates: any) =\u003e {\n    setItems(updateItem(items, id, updates));\n  };\n\n  const remove = (id: string) =\u003e {\n    setItems(removeItem(items, id));\n  };\n\n  const unpackedItems = filterItems(items, { packed: false });\n  const packedItems = filterItems(items, { packed: true });\n\n  const markAllAsUnpacked = () =\u003e {\n    return setItems(items.map((item) =\u003e ({ ...item, packed: false })));\n  };\n\n  return \u003cItemsContext.Provider value={null}\u003e{children}\u003c/ItemsContext.Provider\u003e;\n};\n\nexport default ItemsProvider;\n```\n\n## Putting together our state management package\n\nLet's bundle up all of those actions and lists into one nice little package.\n\n```ts\nconst value = {\n  items,\n  packedItems,\n  unpackedItems,\n  add,\n  remove,\n  update,\n  markAllAsUnpacked,\n};\n```\n\nNow, this time around, we chose to use `useState` instead of `useReducer`, so it's a little tricker. There are a bunch of tricks, we _could_ do, but I'm going to use this as excuse to remind you my favorite trick: _Use TypeScript to teach yourself about TypeScript._\n\nWhat happens if we hover over the `value` we just made?\n\n![](_attachments/Pasted%20image%2020221114142019.png)\n\nOh, look! That seems like a reasonable type that we can use.\n\n```ts\ntype ItemsState = {\n  items: Item[];\n  packedItems: Item[];\n  unpackedItems: Item[];\n  add: (name: string) =\u003e void;\n  remove: (id: string) =\u003e void;\n  update: (id: string, updates: any) =\u003e void;\n  markAllAsUnpacked: () =\u003e void;\n};\n```\n\n## Assert the type\n\nAlright, here is where we wanted to try out the strategy that I previously showed you because we told `ItemsContext` that it's value would be `null` and—clearly—that's a lie.\n\n```tsx\nexport const ItemsContext = createContext({} as ItemsState);\n```\n\nDon't forget actually pass in that value:\n\n```tsx\n\u003cItemsContext.Provider value={value}\u003e{children}\u003c/ItemsContext.Provider\u003e\n```\n\n## Wiring it all up\n\nNow, you can take my word that this all works or we can throw it together real fast. It's up to you.\n\nThe nice part is that TypeScript isn't really going to let us keep any loose ends around as we do this refactor.\n\n(**Note**: I am _only_ going to do the `ItemList` components, there isn't much of a gain in doing it to `NewItem`, `Header`, and `MarkAllAsUnpacked`.)\n\nIn `src/components/application.tsx`, you'll notice that sweet, sweet autocomplete as I pull properties off of the `ItemsContext`.\n\nNext up, `ItemsList` doesn't need those actions at all. We'll remove them and head down to `Item`—following the compiler errors along the way.\n\n## End Result\n\nIn `src/components/application.tsx`:\n\n```diff\n@@ -1,56 +1,21 @@\n-import { useState } from 'react';\n-import {\n-  createItem,\n-  filterItems,\n-  getInitialItems,\n-  removeItem,\n-  updateItem,\n-} from '../lib/items';\n+import { useContext } from 'react';\n+import { ItemsContext } from '../context';\n import Header from './header';\n import ItemList from './item-list';\n import MarkAllAsUnpacked from './mark-all-as-unpacked';\n import NewItem from './new-item';\n\n const Application = () =\u003e {\n-  const [items, setItems] = useState(getInitialItems());\n-\n-  const add = (name: string) =\u003e {\n-    const item = createItem(name);\n-    setItems([...items, item]);\n-  };\n-\n-  const update = (id: string, updates: any) =\u003e {\n-    setItems(updateItem(items, id, updates));\n-  };\n-\n-  const remove = (id: string) =\u003e {\n-    setItems(removeItem(items, id));\n-  };\n-\n-  const unpackedItems = filterItems(items, { packed: false });\n-  const packedItems = filterItems(items, { packed: true });\n-\n-  const markAllAsUnpacked = () =\u003e {\n-    return setItems(items.map((item) =\u003e ({ ...item, packed: false })));\n-  };\n+  const { items, unpackedItems, packedItems, add, markAllAsUnpacked } =\n+    useContext(ItemsContext);\n\n   return (\n     \u003cmain className=\"flex flex-col gap-8 p-8 mx-auto lg:max-w-4xl\"\u003e\n       \u003cHeader items={items} /\u003e\n       \u003cNewItem addItem={add} /\u003e\n       \u003csection className=\"flex flex-col gap-8 md:flex-row\"\u003e\n-        \u003cItemList\n-          title=\"Unpacked Items\"\n-          items={unpackedItems}\n-          update={update}\n-          remove={remove}\n-        /\u003e\n-        \u003cItemList\n-          title=\"Packed Items\"\n-          items={packedItems}\n-          update={update}\n-          remove={remove}\n-        /\u003e\n+        \u003cItemList title=\"Unpacked Items\" items={unpackedItems} /\u003e\n+        \u003cItemList title=\"Packed Items\" items={packedItems} /\u003e\n       \u003c/section\u003e\n       \u003cMarkAllAsUnpacked onClick={markAllAsUnpacked} /\u003e\n     \u003c/main\u003e\n```\n\nIn `src/components/item-list.tsx`:\n\n```diff\n@@ -6,11 +6,9 @@ import Item from './item';\n type ItemsProps = {\n   title: string;\n   items: Item[];\n-  update: (id: string, updates: any) =\u003e void;\n-  remove: (id: string) =\u003e void;\n };\n\n-const ItemList = ({ title = 'Items', items, update, remove }: ItemsProps) =\u003e {\n+const ItemList = ({ title = 'Items', items }: ItemsProps) =\u003e {\n   const [filter, setFilter] = useState('');\n   const id = toKebabCase(title);\n\n@@ -32,7 +30,7 @@ const ItemList = ({ title = 'Items', items, update, remove }: ItemsProps) =\u003e {\n       \u003c/header\u003e\n       \u003cul className=\"flex flex-col gap-2\"\u003e\n         {filteredItems.map((item) =\u003e (\n-          \u003cItem key={item.id} item={item} update={update} remove={remove} /\u003e\n+          \u003cItem key={item.id} item={item} /\u003e\n         ))}\n       \u003c/ul\u003e\n       {isEmpty \u0026\u0026 \u003cp className=\"text-primary-400\"\u003e(Nothing to show.)\u003c/p\u003e}\n```\n\nIn `src/components/item.tsx`:\n\n```diff\n@@ -1,14 +1,14 @@\n import clsx from 'clsx';\n-import { useState } from 'react';\n+import { useContext, useState } from 'react';\n+import { ItemsContext } from '../context';\n\n type ItemProps = {\n   item: Item;\n-  update: (id: string, updates: any) =\u003e void;\n-  remove: (id: string) =\u003e void;\n };\n\n-const Item = ({ item, update, remove }: ItemProps) =\u003e {\n+const Item = ({ item }: ItemProps) =\u003e {\n   const [editing, setEditing] = useState(false);\n+  const { update, remove } = useContext(ItemsContext);\n\n   return (\n     \u003cli className=\"flex items-center gap-2\"\u003e\n```\n","slug":"context-api-solution","title":"Context Api Solution","section":"Context Api","icon":"copyright","filePath":"/home/runner/work/React-with-TypeScript/React-with-TypeScript/lessons/07-context-api/C-context-api-solution.md","nextSlug":null,"prevSlug":"/React-with-TypeScript/lessons/context-api/context-api-exercise"}},"__N_SSG":true},"page":"/lessons/[section]/[slug]","query":{"section":"context-api","slug":"context-api-solution"},"buildId":"PALjGKd3AshwdXjsrKNVy","assetPrefix":"/React-with-TypeScript","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>