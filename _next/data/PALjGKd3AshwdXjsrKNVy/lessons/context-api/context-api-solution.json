{"pageProps":{"post":{"attributes":{},"html":"<h1 id=\"solution\"><strong>Solution</strong></h1>\n<br>\n\n<p>Alright, you can see I did a little bit of the basic set up for you as this is a course on TypeScript and not the Context API itself and you just watched me set up the Context API in a previous example. You&#39;re more than welcome to delete <code>src/context.tsx</code>, if you&#39;d like.</p>\n<p>Let&#39;s port over our state management from <code>src/components/application.tsx</code>:</p>\n<pre><code class=\"language-tsx\">export const ItemsProvider = ({ children }: PropsWithChildren) =&gt; {\n  const [items, setItems] = useState&lt;Item[]&gt;(getInitialItems());\n\n  const add = (name: string) =&gt; {\n    const item = createItem(name);\n    setItems([...items, item]);\n  };\n\n  const update = (id: string, updates: any) =&gt; {\n    setItems(updateItem(items, id, updates));\n  };\n\n  const remove = (id: string) =&gt; {\n    setItems(removeItem(items, id));\n  };\n\n  const unpackedItems = filterItems(items, { packed: false });\n  const packedItems = filterItems(items, { packed: true });\n\n  const markAllAsUnpacked = () =&gt; {\n    return setItems(items.map((item) =&gt; ({ ...item, packed: false })));\n  };\n\n  return &lt;ItemsContext.Provider value={null}&gt;{children}&lt;/ItemsContext.Provider&gt;;\n};\n\nexport default ItemsProvider;\n</code></pre>\n<h2 id=\"putting-together-our-state-management-package\">Putting together our state management package</h2>\n<p>Let&#39;s bundle up all of those actions and lists into one nice little package.</p>\n<pre><code class=\"language-ts\">const value = {\n  items,\n  packedItems,\n  unpackedItems,\n  add,\n  remove,\n  update,\n  markAllAsUnpacked,\n};\n</code></pre>\n<p>Now, this time around, we chose to use <code>useState</code> instead of <code>useReducer</code>, so it&#39;s a little tricker. There are a bunch of tricks, we <em>could</em> do, but I&#39;m going to use this as excuse to remind you my favorite trick: <em>Use TypeScript to teach yourself about TypeScript.</em></p>\n<p>What happens if we hover over the <code>value</code> we just made?</p>\n<p><img src=\"_attachments/Pasted%20image%2020221114142019.png\" alt=\"\"></p>\n<p>Oh, look! That seems like a reasonable type that we can use.</p>\n<pre><code class=\"language-ts\">type ItemsState = {\n  items: Item[];\n  packedItems: Item[];\n  unpackedItems: Item[];\n  add: (name: string) =&gt; void;\n  remove: (id: string) =&gt; void;\n  update: (id: string, updates: any) =&gt; void;\n  markAllAsUnpacked: () =&gt; void;\n};\n</code></pre>\n<h2 id=\"assert-the-type\">Assert the type</h2>\n<p>Alright, here is where we wanted to try out the strategy that I previously showed you because we told <code>ItemsContext</code> that it&#39;s value would be <code>null</code> and—clearly—that&#39;s a lie.</p>\n<pre><code class=\"language-tsx\">export const ItemsContext = createContext({} as ItemsState);\n</code></pre>\n<p>Don&#39;t forget actually pass in that value:</p>\n<pre><code class=\"language-tsx\">&lt;ItemsContext.Provider value={value}&gt;{children}&lt;/ItemsContext.Provider&gt;\n</code></pre>\n<h2 id=\"wiring-it-all-up\">Wiring it all up</h2>\n<p>Now, you can take my word that this all works or we can throw it together real fast. It&#39;s up to you.</p>\n<p>The nice part is that TypeScript isn&#39;t really going to let us keep any loose ends around as we do this refactor.</p>\n<p>(<strong>Note</strong>: I am <em>only</em> going to do the <code>ItemList</code> components, there isn&#39;t much of a gain in doing it to <code>NewItem</code>, <code>Header</code>, and <code>MarkAllAsUnpacked</code>.)</p>\n<p>In <code>src/components/application.tsx</code>, you&#39;ll notice that sweet, sweet autocomplete as I pull properties off of the <code>ItemsContext</code>.</p>\n<p>Next up, <code>ItemsList</code> doesn&#39;t need those actions at all. We&#39;ll remove them and head down to <code>Item</code>—following the compiler errors along the way.</p>\n<h2 id=\"end-result\">End Result</h2>\n<p>In <code>src/components/application.tsx</code>:</p>\n<pre><code class=\"language-diff\">@@ -1,56 +1,21 @@\n-import { useState } from &#39;react&#39;;\n-import {\n-  createItem,\n-  filterItems,\n-  getInitialItems,\n-  removeItem,\n-  updateItem,\n-} from &#39;../lib/items&#39;;\n+import { useContext } from &#39;react&#39;;\n+import { ItemsContext } from &#39;../context&#39;;\n import Header from &#39;./header&#39;;\n import ItemList from &#39;./item-list&#39;;\n import MarkAllAsUnpacked from &#39;./mark-all-as-unpacked&#39;;\n import NewItem from &#39;./new-item&#39;;\n\n const Application = () =&gt; {\n-  const [items, setItems] = useState(getInitialItems());\n-\n-  const add = (name: string) =&gt; {\n-    const item = createItem(name);\n-    setItems([...items, item]);\n-  };\n-\n-  const update = (id: string, updates: any) =&gt; {\n-    setItems(updateItem(items, id, updates));\n-  };\n-\n-  const remove = (id: string) =&gt; {\n-    setItems(removeItem(items, id));\n-  };\n-\n-  const unpackedItems = filterItems(items, { packed: false });\n-  const packedItems = filterItems(items, { packed: true });\n-\n-  const markAllAsUnpacked = () =&gt; {\n-    return setItems(items.map((item) =&gt; ({ ...item, packed: false })));\n-  };\n+  const { items, unpackedItems, packedItems, add, markAllAsUnpacked } =\n+    useContext(ItemsContext);\n\n   return (\n     &lt;main className=&quot;flex flex-col gap-8 p-8 mx-auto lg:max-w-4xl&quot;&gt;\n       &lt;Header items={items} /&gt;\n       &lt;NewItem addItem={add} /&gt;\n       &lt;section className=&quot;flex flex-col gap-8 md:flex-row&quot;&gt;\n-        &lt;ItemList\n-          title=&quot;Unpacked Items&quot;\n-          items={unpackedItems}\n-          update={update}\n-          remove={remove}\n-        /&gt;\n-        &lt;ItemList\n-          title=&quot;Packed Items&quot;\n-          items={packedItems}\n-          update={update}\n-          remove={remove}\n-        /&gt;\n+        &lt;ItemList title=&quot;Unpacked Items&quot; items={unpackedItems} /&gt;\n+        &lt;ItemList title=&quot;Packed Items&quot; items={packedItems} /&gt;\n       &lt;/section&gt;\n       &lt;MarkAllAsUnpacked onClick={markAllAsUnpacked} /&gt;\n     &lt;/main&gt;\n</code></pre>\n<p>In <code>src/components/item-list.tsx</code>:</p>\n<pre><code class=\"language-diff\">@@ -6,11 +6,9 @@ import Item from &#39;./item&#39;;\n type ItemsProps = {\n   title: string;\n   items: Item[];\n-  update: (id: string, updates: any) =&gt; void;\n-  remove: (id: string) =&gt; void;\n };\n\n-const ItemList = ({ title = &#39;Items&#39;, items, update, remove }: ItemsProps) =&gt; {\n+const ItemList = ({ title = &#39;Items&#39;, items }: ItemsProps) =&gt; {\n   const [filter, setFilter] = useState(&#39;&#39;);\n   const id = toKebabCase(title);\n\n@@ -32,7 +30,7 @@ const ItemList = ({ title = &#39;Items&#39;, items, update, remove }: ItemsProps) =&gt; {\n       &lt;/header&gt;\n       &lt;ul className=&quot;flex flex-col gap-2&quot;&gt;\n         {filteredItems.map((item) =&gt; (\n-          &lt;Item key={item.id} item={item} update={update} remove={remove} /&gt;\n+          &lt;Item key={item.id} item={item} /&gt;\n         ))}\n       &lt;/ul&gt;\n       {isEmpty &amp;&amp; &lt;p className=&quot;text-primary-400&quot;&gt;(Nothing to show.)&lt;/p&gt;}\n</code></pre>\n<p>In <code>src/components/item.tsx</code>:</p>\n<pre><code class=\"language-diff\">@@ -1,14 +1,14 @@\n import clsx from &#39;clsx&#39;;\n-import { useState } from &#39;react&#39;;\n+import { useContext, useState } from &#39;react&#39;;\n+import { ItemsContext } from &#39;../context&#39;;\n\n type ItemProps = {\n   item: Item;\n-  update: (id: string, updates: any) =&gt; void;\n-  remove: (id: string) =&gt; void;\n };\n\n-const Item = ({ item, update, remove }: ItemProps) =&gt; {\n+const Item = ({ item }: ItemProps) =&gt; {\n   const [editing, setEditing] = useState(false);\n+  const { update, remove } = useContext(ItemsContext);\n\n   return (\n     &lt;li className=&quot;flex items-center gap-2&quot;&gt;\n</code></pre>\n","markdown":"# **Solution**\n\n<br>\n\nAlright, you can see I did a little bit of the basic set up for you as this is a course on TypeScript and not the Context API itself and you just watched me set up the Context API in a previous example. You're more than welcome to delete `src/context.tsx`, if you'd like.\n\nLet's port over our state management from `src/components/application.tsx`:\n\n```tsx\nexport const ItemsProvider = ({ children }: PropsWithChildren) => {\n  const [items, setItems] = useState<Item[]>(getInitialItems());\n\n  const add = (name: string) => {\n    const item = createItem(name);\n    setItems([...items, item]);\n  };\n\n  const update = (id: string, updates: any) => {\n    setItems(updateItem(items, id, updates));\n  };\n\n  const remove = (id: string) => {\n    setItems(removeItem(items, id));\n  };\n\n  const unpackedItems = filterItems(items, { packed: false });\n  const packedItems = filterItems(items, { packed: true });\n\n  const markAllAsUnpacked = () => {\n    return setItems(items.map((item) => ({ ...item, packed: false })));\n  };\n\n  return <ItemsContext.Provider value={null}>{children}</ItemsContext.Provider>;\n};\n\nexport default ItemsProvider;\n```\n\n## Putting together our state management package\n\nLet's bundle up all of those actions and lists into one nice little package.\n\n```ts\nconst value = {\n  items,\n  packedItems,\n  unpackedItems,\n  add,\n  remove,\n  update,\n  markAllAsUnpacked,\n};\n```\n\nNow, this time around, we chose to use `useState` instead of `useReducer`, so it's a little tricker. There are a bunch of tricks, we _could_ do, but I'm going to use this as excuse to remind you my favorite trick: _Use TypeScript to teach yourself about TypeScript._\n\nWhat happens if we hover over the `value` we just made?\n\n![](_attachments/Pasted%20image%2020221114142019.png)\n\nOh, look! That seems like a reasonable type that we can use.\n\n```ts\ntype ItemsState = {\n  items: Item[];\n  packedItems: Item[];\n  unpackedItems: Item[];\n  add: (name: string) => void;\n  remove: (id: string) => void;\n  update: (id: string, updates: any) => void;\n  markAllAsUnpacked: () => void;\n};\n```\n\n## Assert the type\n\nAlright, here is where we wanted to try out the strategy that I previously showed you because we told `ItemsContext` that it's value would be `null` and—clearly—that's a lie.\n\n```tsx\nexport const ItemsContext = createContext({} as ItemsState);\n```\n\nDon't forget actually pass in that value:\n\n```tsx\n<ItemsContext.Provider value={value}>{children}</ItemsContext.Provider>\n```\n\n## Wiring it all up\n\nNow, you can take my word that this all works or we can throw it together real fast. It's up to you.\n\nThe nice part is that TypeScript isn't really going to let us keep any loose ends around as we do this refactor.\n\n(**Note**: I am _only_ going to do the `ItemList` components, there isn't much of a gain in doing it to `NewItem`, `Header`, and `MarkAllAsUnpacked`.)\n\nIn `src/components/application.tsx`, you'll notice that sweet, sweet autocomplete as I pull properties off of the `ItemsContext`.\n\nNext up, `ItemsList` doesn't need those actions at all. We'll remove them and head down to `Item`—following the compiler errors along the way.\n\n## End Result\n\nIn `src/components/application.tsx`:\n\n```diff\n@@ -1,56 +1,21 @@\n-import { useState } from 'react';\n-import {\n-  createItem,\n-  filterItems,\n-  getInitialItems,\n-  removeItem,\n-  updateItem,\n-} from '../lib/items';\n+import { useContext } from 'react';\n+import { ItemsContext } from '../context';\n import Header from './header';\n import ItemList from './item-list';\n import MarkAllAsUnpacked from './mark-all-as-unpacked';\n import NewItem from './new-item';\n\n const Application = () => {\n-  const [items, setItems] = useState(getInitialItems());\n-\n-  const add = (name: string) => {\n-    const item = createItem(name);\n-    setItems([...items, item]);\n-  };\n-\n-  const update = (id: string, updates: any) => {\n-    setItems(updateItem(items, id, updates));\n-  };\n-\n-  const remove = (id: string) => {\n-    setItems(removeItem(items, id));\n-  };\n-\n-  const unpackedItems = filterItems(items, { packed: false });\n-  const packedItems = filterItems(items, { packed: true });\n-\n-  const markAllAsUnpacked = () => {\n-    return setItems(items.map((item) => ({ ...item, packed: false })));\n-  };\n+  const { items, unpackedItems, packedItems, add, markAllAsUnpacked } =\n+    useContext(ItemsContext);\n\n   return (\n     <main className=\"flex flex-col gap-8 p-8 mx-auto lg:max-w-4xl\">\n       <Header items={items} />\n       <NewItem addItem={add} />\n       <section className=\"flex flex-col gap-8 md:flex-row\">\n-        <ItemList\n-          title=\"Unpacked Items\"\n-          items={unpackedItems}\n-          update={update}\n-          remove={remove}\n-        />\n-        <ItemList\n-          title=\"Packed Items\"\n-          items={packedItems}\n-          update={update}\n-          remove={remove}\n-        />\n+        <ItemList title=\"Unpacked Items\" items={unpackedItems} />\n+        <ItemList title=\"Packed Items\" items={packedItems} />\n       </section>\n       <MarkAllAsUnpacked onClick={markAllAsUnpacked} />\n     </main>\n```\n\nIn `src/components/item-list.tsx`:\n\n```diff\n@@ -6,11 +6,9 @@ import Item from './item';\n type ItemsProps = {\n   title: string;\n   items: Item[];\n-  update: (id: string, updates: any) => void;\n-  remove: (id: string) => void;\n };\n\n-const ItemList = ({ title = 'Items', items, update, remove }: ItemsProps) => {\n+const ItemList = ({ title = 'Items', items }: ItemsProps) => {\n   const [filter, setFilter] = useState('');\n   const id = toKebabCase(title);\n\n@@ -32,7 +30,7 @@ const ItemList = ({ title = 'Items', items, update, remove }: ItemsProps) => {\n       </header>\n       <ul className=\"flex flex-col gap-2\">\n         {filteredItems.map((item) => (\n-          <Item key={item.id} item={item} update={update} remove={remove} />\n+          <Item key={item.id} item={item} />\n         ))}\n       </ul>\n       {isEmpty && <p className=\"text-primary-400\">(Nothing to show.)</p>}\n```\n\nIn `src/components/item.tsx`:\n\n```diff\n@@ -1,14 +1,14 @@\n import clsx from 'clsx';\n-import { useState } from 'react';\n+import { useContext, useState } from 'react';\n+import { ItemsContext } from '../context';\n\n type ItemProps = {\n   item: Item;\n-  update: (id: string, updates: any) => void;\n-  remove: (id: string) => void;\n };\n\n-const Item = ({ item, update, remove }: ItemProps) => {\n+const Item = ({ item }: ItemProps) => {\n   const [editing, setEditing] = useState(false);\n+  const { update, remove } = useContext(ItemsContext);\n\n   return (\n     <li className=\"flex items-center gap-2\">\n```\n","slug":"context-api-solution","title":"Context Api Solution","section":"Context Api","icon":"copyright","filePath":"/home/runner/work/React-with-TypeScript/React-with-TypeScript/lessons/07-context-api/C-context-api-solution.md","nextSlug":null,"prevSlug":"/React-with-TypeScript/lessons/context-api/context-api-exercise"}},"__N_SSG":true}